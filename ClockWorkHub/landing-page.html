<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>ClockWork - Universal Business Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- EmailJS -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        emailjs.init("NwZwsMzjBz7TG8nFb");
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        :root {
            /* ClockWork dark theme colors */
            --clockwork-primary: #3b82f6;
            --clockwork-secondary: #60a5fa;
            --clockwork-accent: #fbbf24;
            --clockwork-dark: #0f172a;
            --clockwork-darker: #020617;
            --clockwork-light: #1e293b;
            --clockwork-gray: #64748b;
            --clockwork-text: #e2e8f0;
            
            /* Keep these for chat functionality */
            --fb-blue: #0084ff;
            --fb-gray: #1e293b;
        }
        
        * {
            font-family: 'Inter', sans-serif;
        }

        /* Mobile-friendly base styles */
        html {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }

        body {
            background: var(--clockwork-darker);
            color: var(--clockwork-text);
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Prevent body scroll lock on mobile */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
        
        /* Lightning animation styles */
        @keyframes lightning {
            0%, 90% { opacity: 0; }
            92% { opacity: 1; }
            94% { opacity: 0.5; }
            96% { opacity: 1; }
            100% { opacity: 0; }
        }

        @keyframes lightning-glow {
            0%, 90% { 
                opacity: 0;
                filter: blur(0);
            }
            92% { 
                opacity: 0.5;
                filter: blur(20px);
            }
            94% { 
                opacity: 0.3;
                filter: blur(10px);
            }
            96% { 
                opacity: 0.8;
                filter: blur(30px);
            }
            100% { 
                opacity: 0;
                filter: blur(0);
            }
        }

        .lightning-bolt {
            position: absolute;
            width: 2px;
            background: linear-gradient(to bottom, transparent, #60a5fa, #3b82f6, transparent);
            opacity: 0;
            animation: lightning 4s infinite;
            filter: drop-shadow(0 0 2px #3b82f6);
        }

        .lightning-bolt-thick {
            width: 4px;
            filter: drop-shadow(0 0 6px #3b82f6) drop-shadow(0 0 12px #60a5fa);
        }

        .lightning-glow {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #3b82f6, transparent);
            opacity: 0;
            animation: lightning-glow 4s infinite;
            pointer-events: none;
        }

        .lightning-container {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
            z-index: 1;
        }

        /* Generate multiple lightning bolts with different delays */
        .lightning-bolt:nth-child(1) { 
            left: 10%; 
            height: 300px; 
            animation-delay: 0s;
            transform: rotate(-5deg);
        }
        .lightning-bolt:nth-child(2) { 
            right: 15%; 
            height: 400px; 
            animation-delay: 1.5s;
            transform: rotate(3deg);
        }
        .lightning-bolt:nth-child(3) { 
            left: 40%; 
            height: 250px; 
            animation-delay: 3s;
            transform: rotate(-2deg);
        }
        .lightning-bolt:nth-child(4) { 
            right: 30%; 
            height: 350px; 
            animation-delay: 2.2s;
            transform: rotate(4deg);
        }
        .lightning-bolt:nth-child(5) { 
            left: 70%; 
            height: 280px; 
            animation-delay: 0.8s;
            transform: rotate(-3deg);
        }

        /* Dark theme gradient text */
        .gradient-text-dark {
            background: linear-gradient(135deg, #60a5fa 0%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-gradient-dark {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            position: relative;
            overflow: hidden;
        }

        .card-dark {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-card {
            transition: all 0.3s ease;
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.15);
            border-color: #3b82f6;
        }

        /* Electric border animation */
        @keyframes electric-border {
            0%, 100% { 
                box-shadow: 0 0 5px #3b82f6, inset 0 0 5px #3b82f6;
            }
            50% { 
                box-shadow: 0 0 20px #60a5fa, inset 0 0 10px #60a5fa;
            }
        }

        .electric-border:hover {
            animation: electric-border 2s infinite;
        }
        
        .comparison-table {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .industry-badge {
            transition: all 0.3s ease;
            cursor: pointer;
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .industry-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }
        
        /* Mobile-friendly modal styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 1rem;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 768px) {
            .modal-overlay {
                align-items: flex-start;
                padding-top: 2rem;
                padding-bottom: 2rem;
            }
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
            backdrop-filter: blur(8px);
        }

        .modal-content {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        @media (max-width: 768px) {
            .modal-content {
                max-height: none;
                max-width: 100%;
                margin: 0 auto;
            }
        }

        .modal-overlay.show .modal-content {
            transform: scale(1) translateY(0);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        .check-mark {
            background: #10b981;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .x-mark {
            background: #ef4444;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        /* Demo Styles - Dark Theme */
        .demo-container {
            background: var(--clockwork-dark);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            min-height: 700px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .app-container {
            background-color: var(--clockwork-darker);
            min-height: 100vh;
            color: var(--clockwork-text);
        }
        
        .clockwork-gradient {
            background: linear-gradient(135deg, var(--clockwork-dark) 0%, var(--clockwork-primary) 100%);
            min-height: 100vh;
            position: relative;
        }
        
        .login-card {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 3rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 440px;
            margin: 0 auto;
        }
        
        .clockwork-card {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .clockwork-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.2);
        }
        
        .clockwork-button {
            background: var(--clockwork-primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .clockwork-button.login {
            padding: 1rem 2rem;
            border-radius: 12px;
            font-size: 1.1rem;
            width: 100%;
        }
        
        .clockwork-button:hover {
            background: #2563eb;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .clockwork-button:disabled {
            background: #475569;
            cursor: not-allowed;
            transform: none;
        }
        
        .clockwork-button-secondary {
            background: var(--clockwork-accent);
            color: var(--clockwork-dark);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .clockwork-button-secondary:hover {
            background: #f59e0b;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.4);
        }
        
        .clockwork-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--clockwork-darker);
            color: var(--clockwork-text);
        }
        
        .clockwork-input:focus {
            outline: none;
            border-color: var(--clockwork-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .clockwork-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--clockwork-darker);
            color: var(--clockwork-text);
            cursor: pointer;
        }
        
        .clockwork-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-client { background: rgba(219, 234, 254, 0.2); color: #93bbfc; }
        .badge-specialist { background: rgba(209, 250, 229, 0.2); color: #6ee7b7; }
        .badge-admin { background: rgba(254, 243, 199, 0.2); color: #fcd34d; }
        .badge-owner { background: rgba(233, 213, 255, 0.2); color: #c4b5fd; }
        .badge-engineer { background: rgba(254, 226, 226, 0.2); color: #fca5a5; }
        
        .clockwork-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            background: transparent;
            color: var(--clockwork-text);
        }
        
        .clockwork-tab:hover {
            background: rgba(251, 191, 36, 0.1);
        }
        
        .clockwork-tab.active {
            background: var(--clockwork-primary);
            color: white;
        }
        
        .text-xxs {
            font-size: 0.65rem;
            line-height: 1rem;
        }
        
        .clockwork-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1.5rem;
        }
        
        .clockwork-logo.small {
            justify-content: flex-start;
            margin-bottom: 0;
            gap: 0.75rem;
        }
        
        .clockwork-logo.small .logo-icon {
            width: 40px;
            height: 40px;
        }
        
        .logo-icon {
            width: 80px;
            height: 80px;
            position: relative;
            background: var(--clockwork-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4), 0 0 20px rgba(59, 130, 246, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo-icon::before {
            content: 'üåç';
            font-size: 2.5rem;
            position: absolute;
        }
        
        .logo-icon::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid var(--clockwork-accent);
            border-radius: 50%;
            border-top-color: transparent;
            border-right-color: transparent;
            animation: spin 3s linear infinite;
        }
        
        .clockwork-logo.small .logo-icon::before {
            font-size: 1.5rem;
        }
        
        .clockwork-logo.small .logo-icon::after {
            border-width: 2px;
        }
        
        /* Main content wrapper fix */
        main {
            position: relative;
            z-index: 1;
        }

        /* Ensure sections are scrollable */
        section {
            position: relative;
            overflow: visible;
        }

        /* Fix for mobile viewport height */
        @supports (height: 100dvh) {
            .hero-gradient-dark {
                min-height: 100dvh;
            }
        }
        
        .logo-text-primary {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            letter-spacing: 0.05em;
            color: var(--clockwork-text);
        }
        
        .logo-text-secondary {
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--clockwork-gray);
        }
        
        .login-toggle {
            display: flex;
            margin-bottom: 2rem;
            border-radius: 12px;
            overflow: hidden;
            background: var(--clockwork-darker);
            padding: 4px;
        }
        
        .login-toggle button {
            flex: 1;
            padding: 0.875rem;
            border: none;
            background: transparent;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 8px;
            color: var(--clockwork-text);
        }
        
        .login-toggle button.active {
            background: var(--clockwork-primary);
            color: white;
        }
        
        .login-toggle button:not(.active) {
            color: var(--clockwork-gray);
        }
        
        .brand-tagline {
            color: var(--clockwork-gray);
            margin-bottom: 2rem;
            font-size: 1.1rem;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--clockwork-text);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--clockwork-primary) 0%, var(--clockwork-accent) 100%);
            transition: width 0.5s ease;
            border-radius: 9999px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .stat-card {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--clockwork-primary) 0%, var(--clockwork-accent) 100%);
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-top: 2px solid var(--clockwork-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            background: rgba(254, 226, 226, 0.1);
            color: #fca5a5;
            padding: 0.75rem;
            border-radius: 8px;
            border: 1px solid rgba(252, 165, 165, 0.3);
            margin: 0.5rem 0;
            font-size: 0.875rem;
        }
        
        .success-message {
            background: rgba(209, 250, 229, 0.1);
            color: #6ee7b7;
            padding: 0.75rem;
            border-radius: 8px;
            border: 1px solid rgba(110, 231, 183, 0.3);
            margin: 0.5rem 0;
            font-size: 0.875rem;
        }
        
        /* Facebook-style Chat Styles - Dark Theme */
        .chat-container {
            display: flex;
            height: 600px;
            background: var(--clockwork-light);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chat-sidebar {
            width: 320px;
            background: var(--clockwork-light);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--clockwork-light);
        }
        
        .chat-search {
            padding: 0.5rem 1rem;
            background: var(--clockwork-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            width: 100%;
            font-size: 0.875rem;
            color: var(--clockwork-text);
        }
        
        .chat-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .chat-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }
        
        .chat-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .chat-item.active {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid var(--clockwork-primary);
        }
        
        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--clockwork-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 0.75rem;
            position: relative;
        }
        
        .online-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: #44b700;
            border-radius: 50%;
            border: 2px solid var(--clockwork-light);
        }
        
        .chat-item-info {
            flex: 1;
            min-width: 0;
        }
        
        .chat-item-name {
            font-weight: 500;
            margin-bottom: 0.125rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--clockwork-text);
        }
        
        .chat-item-message {
            font-size: 0.875rem;
            color: var(--clockwork-gray);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .chat-item-time {
            font-size: 0.75rem;
            color: var(--clockwork-gray);
            position: absolute;
            top: 0.75rem;
            right: 1rem;
        }
        
        .unread-count {
            position: absolute;
            bottom: 0.75rem;
            right: 1rem;
            background: var(--fb-blue);
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
        }
        
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .chat-main-header {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--clockwork-light);
        }
        
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: var(--clockwork-darker);
        }
        
        .message-group {
            margin-bottom: 1rem;
        }
        
        .message-bubble {
            max-width: 70%;
            padding: 0.5rem 1rem;
            border-radius: 18px;
            margin-bottom: 0.125rem;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
        
        .message-bubble.zoom-meeting {
            background: linear-gradient(45deg, #2D8CFF, #0B5CFF) !important;
            color: white !important;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(11, 92, 255, 0.3);
        }
        
        .message-sent {
            background: var(--fb-blue);
            color: white;
            margin-left: auto;
        }
        
        .message-received {
            background: rgba(255, 255, 255, 0.1);
            color: var(--clockwork-text);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message-time {
            font-size: 0.75rem;
            color: var(--clockwork-gray);
            margin: 0.25rem 0.5rem;
        }
        
        .message-sent + .message-time {
            text-align: right;
        }
        
        .chat-input-container {
            padding: 1rem;
            background: var(--clockwork-light);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .chat-input {
            flex: 1;
            padding: 0.5rem 1rem;
            background: var(--clockwork-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 0.875rem;
            outline: none;
            resize: none;
            min-height: 36px;
            max-height: 100px;
            line-height: 1.4;
            color: var(--clockwork-text);
        }
        
        .chat-send-btn {
            background: var(--fb-blue);
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .chat-send-btn:hover {
            transform: scale(1.1);
        }
        
        .chat-send-btn:disabled {
            background: #475569;
            cursor: not-allowed;
            transform: none;
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            width: fit-content;
            margin-bottom: 0.5rem;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--clockwork-gray);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 80%, 100% {
                opacity: 0;
                transform: scale(0.8);
            }
            40% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .pain-scale-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-weight: 600;
        }
        
        .pain-scale-btn:hover {
            transform: scale(1.1);
        }
        
        .pain-scale-btn.selected {
            border-color: var(--clockwork-primary);
            transform: scale(1.15);
        }
        
        .pain-0 { background: rgba(209, 250, 229, 0.3); color: #6ee7b7; }
        .pain-1 { background: rgba(254, 243, 199, 0.3); color: #fcd34d; }
        .pain-2 { background: rgba(254, 215, 170, 0.3); color: #fdba74; }
        .pain-3 { background: rgba(254, 202, 202, 0.3); color: #fca5a5; }
        .pain-4 { background: rgba(248, 113, 113, 0.3); color: #f87171; }
        .pain-5 { background: rgba(220, 38, 38, 0.3); color: #dc2626; }
        
        .mood-btn {
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 8px;
            border: 2px solid transparent;
        }
        
        .mood-btn:hover {
            transform: scale(1.2);
        }
        
        .mood-btn.selected {
            border-color: var(--clockwork-primary);
            background: rgba(59, 130, 246, 0.1);
        }
        
        .exercise-card {
            background: var(--clockwork-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .zoom-btn {
            background: linear-gradient(45deg, #2D8CFF, #0B5CFF);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .zoom-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(11, 92, 255, 0.4);
        }
        
        .demo-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 1rem;
            backdrop-filter: blur(4px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .demo-modal-content {
            background: var(--clockwork-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
            animation: modalFadeIn 0.3s ease-out;
        }
        
        .demo-modal-content.max-w-4xl {
            max-width: 56rem;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .assignment-form {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(251, 191, 36, 0.1) 100%);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .assignment-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--clockwork-primary);
        }
        
        .specialist-note {
            background: rgba(251, 191, 36, 0.1);
            border-left: 4px solid var(--clockwork-accent);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
            color: var(--clockwork-text);
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        .mood-summary-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.2) 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .pain-summary-card {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(251, 191, 36, 0.2) 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }
        
        .workout-image-upload {
            position: relative;
            width: 150px;
            height: 150px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1rem 0;
            background: var(--clockwork-darker);
        }
        
        .workout-image-upload:hover {
            border-color: var(--clockwork-primary);
            background: rgba(59, 130, 246, 0.1);
        }
        
        .workout-image-upload input[type="file"] {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        .workout-image-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }
        
        .measurement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .measurement-input-group {
            display: flex;
            flex-direction: column;
        }
        
        .measurement-input-group label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--clockwork-text);
            margin-bottom: 0.25rem;
        }
        
        .measurement-input-group input {
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 0.875rem;
            background: var(--clockwork-darker);
            color: var(--clockwork-text);
        }
        
        .measurement-category {
            background: var(--clockwork-darker);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .measurement-category h4 {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--clockwork-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .bmr-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: 1rem;
            font-size: 0.875rem;
            font-weight: 400;
        }
        
        .bmr-toggle input[type="checkbox"] {
            width: 1rem;
            height: 1rem;
            cursor: pointer;
        }

        /* Dark theme inputs and selects */
        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="number"],
        input[type="date"],
        input[type="time"],
        input[type="url"],
        textarea,
        select {
            background: var(--clockwork-darker);
            color: var(--clockwork-text);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus,
        input[type="number"]:focus,
        input[type="date"]:focus,
        input[type="time"]:focus,
        input[type="url"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--clockwork-primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Scrollbar styling for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--clockwork-darker);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Dark theme for tables */
        table {
            color: var(--clockwork-text);
        }

        thead tr {
            background: var(--clockwork-darker) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
        }

        tbody tr:hover {
            background: rgba(255, 255, 255, 0.05) !important;
        }

        /* Lightning effect on buttons */
        @keyframes lightning-button {
            0%, 100% { 
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
            }
            50% { 
                box-shadow: 0 4px 20px rgba(59, 130, 246, 0.8), 0 0 40px rgba(96, 165, 250, 0.6);
            }
        }

        .clockwork-button:hover,
        .clockwork-button-secondary:hover {
            animation: lightning-button 2s infinite;
        }

        /* Glowing nav effect */
        nav {
            background: rgba(15, 23, 42, 0.95) !important;
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        nav a {
            color: var(--clockwork-text) !important;
        }

        nav a:hover {
            color: var(--clockwork-primary) !important;
        }

        /* Mobile-specific fixes */
        @media (max-width: 768px) {
            html, body {
                overflow-x: hidden;
                overflow-y: auto !important;
                -webkit-overflow-scrolling: touch !important;
                height: auto !important;
                position: relative !important;
            }

            .hero-gradient-dark {
                min-height: 100vh;
                height: auto;
            }

            section {
                overflow: visible !important;
            }

            .modal-content {
                padding: 1.5rem;
                border-radius: 16px;
            }

            /* Better touch targets */
            .clockwork-button,
            .clockwork-button-secondary,
            button {
                min-height: 44px;
                touch-action: manipulation;
            }

            /* Improve input accessibility on mobile */
            input,
            select,
            textarea {
                font-size: 16px !important; /* Prevents zoom on iOS */
                touch-action: manipulation;
            }

            /* Better mobile navigation */
            nav {
                position: sticky;
                top: 0;
                z-index: 40;
            }

            /* Responsive grid adjustments */
            .grid {
                gap: 0.75rem;
            }

            /* Chat adjustments for mobile */
            .chat-container {
                height: 100vh;
                max-height: 500px;
            }

            .chat-sidebar {
                width: 280px;
            }
        }

        /* iOS-specific fixes */
        @supports (-webkit-touch-callout: none) {
            /* iOS momentum scrolling */
            html, body {
                height: 100%;
                overflow-y: scroll;
                -webkit-overflow-scrolling: touch;
                position: relative;
            }
            
            .modal-overlay,
            .modal-content,
            .chat-messages,
            .chat-list {
                -webkit-overflow-scrolling: touch;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-slate-900/95 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-2">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-yellow-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-clock text-white"></i>
                    </div>
                    <span class="text-xl font-bold text-white">ClockWork</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#features" class="hover:text-blue-400 transition-colors">Features</a>
                    <a href="#industries" class="hover:text-blue-400 transition-colors">Industries</a>
                    <a href="#comparison" class="hover:text-blue-400 transition-colors">Compare</a>
                    <a href="#demo" class="hover:text-blue-400 transition-colors">Live Demo</a>
                    <button onclick="openContactModal()" class="bg-gradient-to-r from-blue-600 to-yellow-500 text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all electric-border">Get Started</button>
                </div>
                <div class="md:hidden">
                    <button onclick="openContactModal()" class="bg-gradient-to-r from-blue-600 to-yellow-500 text-white px-4 py-2 rounded-lg text-sm">Get Started</button>
                </div>
            </div>
        </div>
    </nav>

    <main>
    <!-- Hero Section -->
    <section class="hero-gradient-dark text-white pt-24 pb-20">
        <div class="lightning-container">
            <div class="lightning-bolt"></div>
            <div class="lightning-bolt lightning-bolt-thick"></div>
            <div class="lightning-bolt"></div>
            <div class="lightning-bolt lightning-bolt-thick"></div>
            <div class="lightning-bolt"></div>
            <div class="lightning-glow" style="top: 20%; left: 10%;"></div>
            <div class="lightning-glow" style="top: 60%; right: 20%;"></div>
        </div>
        <div class="max-w-7xl mx-auto px-4 relative">
            <div class="text-center max-w-4xl mx-auto">
                <div class="mb-6">
                    <span class="inline-flex items-center gap-2 bg-white/10 backdrop-blur px-4 py-2 rounded-full text-sm border border-white/20">
                        <i class="fas fa-sparkles text-yellow-400"></i>
                        One Platform. Any Industry. Unlimited Possibilities.
                    </span>
                </div>
                
                <h1 class="text-5xl md:text-6xl font-bold mb-6">
                    The Last Business Platform
                    <span class="block gradient-text-dark">You'll Ever Need</span>
                </h1>
                
                <p class="text-xl text-gray-300 mb-8 leading-relaxed">
                    Stop paying monthly fees for limited features. Get enterprise-level client management, 
                    real-time communication, progress tracking, and complete business automation - 
                    all for one simple payment.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center mb-12">
                    <button onclick="scrollToSection('demo')" class="bg-white text-gray-900 px-8 py-4 rounded-lg font-semibold hover:shadow-xl transition-all">
                        <i class="fas fa-play mr-2"></i>
                        Try Live Demo
                    </button>
                    <button onclick="scrollToSection('features')" class="border-2 border-white/30 backdrop-blur px-8 py-4 rounded-lg font-semibold hover:bg-white/10 transition-all">
                        <i class="fas fa-list mr-2"></i>
                        See All Features
                    </button>
                </div>
                
                <div class="grid grid-cols-3 gap-8 max-w-2xl mx-auto">
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-1">One Payment</div>
                        <div class="text-gray-400">Forever Yours</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-1">All Features</div>
                        <div class="text-gray-400">No Limits</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-1">Any Industry</div>
                        <div class="text-gray-400">Fully Adaptable</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Universal Features Section -->
    <section id="features" class="py-20 bg-slate-900">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold mb-4 text-white">Universal Features That Transform Any Business</h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    Every feature is designed to work seamlessly across industries. What's "workouts" for fitness 
                    becomes "projects" for consultants, "lessons" for educators, or "treatments" for healthcare.
                </p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-users text-blue-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Multi-Role User System</h3>
                    <p class="text-gray-400 mb-4">Clients, specialists, admins, owners - perfect role management for any business structure.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Unlimited user accounts</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Custom permission levels</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Client-specialist matching</span>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-comments text-purple-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Real-Time Communication</h3>
                    <p class="text-gray-400 mb-4">Built-in chat with Zoom integration keeps everyone connected professionally.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Instant messaging system</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Zoom scheduling built-in</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>File & image sharing</span>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-chart-line text-green-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Progress Tracking</h3>
                    <p class="text-gray-400 mb-4">Visual dashboards and analytics that adapt to any metric your business needs.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Custom metrics tracking</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Beautiful visualizations</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Automated reporting</span>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-yellow-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-tasks text-yellow-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Task Management</h3>
                    <p class="text-gray-400 mb-4">Assign, track, and complete any type of work - exercises, projects, lessons, treatments.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Flexible task creation</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Progress monitoring</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Feedback collection</span>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-red-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-bullseye text-red-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Goal Setting</h3>
                    <p class="text-gray-400 mb-4">Set and track any objective - weight loss, project milestones, learning goals, recovery targets.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Visual progress bars</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Deadline management</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Achievement tracking</span>
                        </div>
                    </div>
                </div>
                
                <div class="feature-card rounded-xl p-6">
                    <div class="w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center mb-4">
                        <i class="fas fa-file-export text-indigo-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3 text-white">Data Export</h3>
                    <p class="text-gray-400 mb-4">Your data, always accessible. Export reports, analytics, and client information anytime.</p>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>One-click exports</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Multiple formats</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="check-mark mt-0.5">‚úì</span>
                            <span>Automated backups</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Industries Section -->
    <section id="industries" class="py-20 bg-slate-950">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold mb-4 text-white">One Platform, Endless Industries</h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    See how the same powerful features transform to meet the unique needs of any service business
                </p>
            </div>
            
            <div class="grid md:grid-cols-4 gap-4 mb-8">
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üèãÔ∏è</div>
                    <h4 class="font-semibold text-white">Fitness & Training</h4>
                    <p class="text-sm text-gray-400 mt-2">Workouts, nutrition, progress</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üßò</div>
                    <h4 class="font-semibold text-white">Yoga & Wellness</h4>
                    <p class="text-sm text-gray-400 mt-2">Classes, meditation, flexibility</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üè•</div>
                    <h4 class="font-semibold text-white">Healthcare</h4>
                    <p class="text-sm text-gray-400 mt-2">Treatments, recovery, monitoring</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üíº</div>
                    <h4 class="font-semibold text-white">Consulting</h4>
                    <p class="text-sm text-gray-400 mt-2">Projects, deliverables, KPIs</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üéì</div>
                    <h4 class="font-semibold text-white">Education</h4>
                    <p class="text-sm text-gray-400 mt-2">Lessons, assignments, grades</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üéµ</div>
                    <h4 class="font-semibold text-white">Music & Arts</h4>
                    <p class="text-sm text-gray-400 mt-2">Practice, technique, recitals</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">ü•ã</div>
                    <h4 class="font-semibold text-white">Martial Arts</h4>
                    <p class="text-sm text-gray-400 mt-2">Training, belts, competitions</p>
                </div>
                
                <div class="industry-badge rounded-lg p-6 text-center">
                    <div class="text-4xl mb-3">üíÜ</div>
                    <h4 class="font-semibold text-white">Therapy & Rehab</h4>
                    <p class="text-sm text-gray-400 mt-2">Sessions, progress, goals</p>
                </div>
            </div>
            
            <div class="bg-gradient-to-r from-blue-600 to-yellow-500 text-white rounded-2xl p-8 text-center electric-border">
                <h3 class="text-2xl font-bold mb-3">Your Industry Not Listed?</h3>
                <p class="text-lg mb-6">The platform adapts to ANY service-based business. Just change the terminology and it's yours.</p>
                <button onclick="openContactModal()" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                    Let's Discuss Your Industry
                </button>
            </div>
        </div>
    </section>

    <!-- Comparison Section -->
    <section id="comparison" class="py-20 bg-slate-900">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold mb-4 text-white">Why Pay Monthly When You Can Own It?</h2>
                <p class="text-xl text-gray-400">Compare our one-time payment to endless monthly fees</p>
            </div>
            
            <div class="comparison-table rounded-2xl p-8 max-w-5xl mx-auto">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b-2 border-gray-700">
                                <th class="text-left py-4 px-4 text-gray-300">Feature</th>
                                <th class="text-center py-4 px-4">
                                    <div class="font-bold text-blue-400">ClockWork</div>
                                    <div class="text-sm text-gray-400">One-Time Payment</div>
                                </th>
                                <th class="text-center py-4 px-4">
                                    <div class="font-bold text-gray-300">MindBody</div>
                                    <div class="text-sm text-gray-400">$279/month</div>
                                </th>
                                <th class="text-center py-4 px-4">
                                    <div class="font-bold text-gray-300">Trainerize</div>
                                    <div class="text-sm text-gray-400">$149/month</div>
                                </th>
                                <th class="text-center py-4 px-4">
                                    <div class="font-bold text-gray-300">Practice Better</div>
                                    <div class="text-sm text-gray-400">$89/month</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-700">
                                <td class="py-4 px-4 font-medium text-gray-300">Unlimited Users</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                            </tr>
                            <tr class="border-b border-gray-700 bg-slate-800/50">
                                <td class="py-4 px-4 font-medium text-gray-300">Real-time Chat</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-4 px-4 font-medium text-gray-300">Zoom Integration</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                            </tr>
                            <tr class="border-b border-gray-700 bg-slate-800/50">
                                <td class="py-4 px-4 font-medium text-gray-300">Custom Branding</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4 text-yellow-500">Extra $$</td>
                                <td class="text-center py-4 text-yellow-500">Extra $$</td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-4 px-4 font-medium text-gray-300">Data Export</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4 text-yellow-500">Limited</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                            </tr>
                            <tr class="border-b border-gray-700 bg-slate-800/50">
                                <td class="py-4 px-4 font-medium text-gray-300">Works Offline</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                            </tr>
                            <tr class="border-b border-gray-700">
                                <td class="py-4 px-4 font-medium text-gray-300">Industry Adaptable</td>
                                <td class="text-center py-4"><span class="check-mark">‚úì</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4"><span class="x-mark">‚úó</span></td>
                                <td class="text-center py-4 text-yellow-500">Limited</td>
                            </tr>
                            <tr class="bg-blue-900/30">
                                <td class="py-4 px-4 font-bold text-white">3-Year Cost</td>
                                <td class="text-center py-4 font-bold text-blue-400">$299 once</td>
                                <td class="text-center py-4 font-bold text-red-400">$10,044</td>
                                <td class="text-center py-4 font-bold text-red-400">$5,364</td>
                                <td class="text-center py-4 font-bold text-red-400">$3,204</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-8 bg-slate-800/50 rounded-lg p-6 text-center">
                    <p class="text-lg font-semibold mb-2 text-white">üí° The Math is Simple</p>
                    <p class="text-gray-400">Why pay $3,000+ every year when you can own a better solution forever?</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Demo Section -->
    <section id="demo" class="py-20 bg-slate-950">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-bold mb-4 text-white">Experience It Live Right Now</h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    This is a real, working platform. Create accounts, assign tasks, track progress - 
                    everything works. See for yourself how it can transform your business.
                </p>
            </div>
            
            <div class="card-dark rounded-2xl shadow-xl p-8">
                <div class="mb-6">
                    <div class="flex flex-wrap gap-4 justify-center">
                        <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-400 mb-2">üèÉ Client Login</h4>
                            <p class="text-sm text-gray-300">john.client@example.com</p>
                            <p class="text-sm text-gray-400">password123</p>
                        </div>
                        <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-4">
                            <h4 class="font-semibold text-green-400 mb-2">ü©∫ Specialist Login</h4>
                            <p class="text-sm text-gray-300">sarah.specialist@clockwork.com</p>
                            <p class="text-sm text-gray-400">specialist123</p>
                        </div>
                        <div class="bg-purple-500/10 border border-purple-500/30 rounded-lg p-4">
                            <h4 class="font-semibold text-purple-400 mb-2">‚öôÔ∏è Admin Login</h4>
                            <p class="text-sm text-gray-300">admin@clockwork.com</p>
                            <p class="text-sm text-gray-400">admin123</p>
                        </div>
                        <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4">
                            <h4 class="font-semibold text-yellow-400 mb-2">üëë Owner Login</h4>
                            <p class="text-sm text-gray-300">owner@clockwork.com</p>
                            <p class="text-sm text-gray-400">owner123</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-500 text-center mt-4">
                        <i class="fas fa-info-circle"></i> Demo resets when you log out - feel free to explore everything!
                    </p>
                </div>
                
                <div id="demo-root" class="demo-container"></div>
            </div>
        </div>
    </section>

    <!-- Revenue Calculator Section -->
    <section class="py-20 bg-slate-900">
        <div class="max-w-4xl mx-auto px-4">
            <div class="bg-gradient-to-r from-blue-600 to-yellow-500 text-white rounded-2xl p-8 electric-border">
                <h2 class="text-3xl font-bold mb-6 text-center">Quick ROI Calculator</h2>
                
                <div class="bg-white/10 backdrop-blur rounded-xl p-6 mb-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm mb-2">Number of Clients</label>
                            <input type="number" id="clientCount" value="50" class="w-full px-4 py-2 rounded-lg text-gray-900" onchange="calculateROI()">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">Average Monthly Fee</label>
                            <input type="number" id="monthlyFee" value="100" class="w-full px-4 py-2 rounded-lg text-gray-900" onchange="calculateROI()">
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <p class="text-lg mb-2">Your Monthly Revenue Potential:</p>
                    <p class="text-5xl font-bold mb-4" id="revenueDisplay">$5,000</p>
                    <p class="text-sm opacity-80">Platform pays for itself in less than 1 month!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-20 bg-gradient-to-b from-slate-950 to-slate-900">
        <div class="max-w-4xl mx-auto text-center px-4">
            <h2 class="text-4xl font-bold mb-6 text-white">Ready to Own Your Business Platform?</h2>
            <p class="text-xl text-gray-400 mb-8">
                Stop renting software. Start owning your business infrastructure.
            </p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="bg-slate-800/50 border border-white/10 rounded-lg p-6">
                    <div class="text-3xl mb-3">‚ö°</div>
                    <h3 class="font-semibold mb-2 text-white">Quick Setup</h3>
                    <p class="text-gray-400">Running in minutes, not months</p>
                </div>
                <div class="bg-slate-800/50 border border-white/10 rounded-lg p-6">
                    <div class="text-3xl mb-3">üéØ</div>
                    <h3 class="font-semibold mb-2 text-white">Perfect Fit</h3>
                    <p class="text-gray-400">Adapts to your exact needs</p>
                </div>
                <div class="bg-slate-800/50 border border-white/10 rounded-lg p-6">
                    <div class="text-3xl mb-3">üíé</div>
                    <h3 class="font-semibold mb-2 text-white">Yours Forever</h3>
                    <p class="text-gray-400">No subscriptions, no limits</p>
                </div>
            </div>
            
            <button onclick="openContactModal()" class="bg-gradient-to-r from-blue-500 to-yellow-500 text-white px-12 py-4 rounded-lg text-xl font-semibold hover:shadow-2xl transform hover:scale-105 transition-all electric-border">
                Get Your Platform Today
            </button>
        </div>
    </section>
    </main>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal-overlay">
        <div class="modal-content max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-white">Let's Transform Your Business</h3>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-300 text-2xl">&times;</button>
            </div>
            
<form id="contactForm" onsubmit="handleSubmit(event)" class="space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">First Name <span class="text-red-400">*</span></label>
                        <input type="text" name="firstName" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">Last Name <span class="text-red-400">*</span></label>
                        <input type="text" name="lastName" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Email <span class="text-red-400">*</span></label>
                    <input type="email" name="email" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Phone Number <span class="text-gray-500">(Recommended)</span></label>
                    <input type="tel" name="phone" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none" placeholder="+1 (555) 123-4567">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Business Type <span class="text-red-400">*</span></label>
                    <select name="businessType" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none">
                        <option value="">Select your industry...</option>
                        <option value="fitness">Fitness & Training</option>
                        <option value="healthcare">Healthcare & Therapy</option>
                        <option value="wellness">Wellness & Yoga</option>
                        <option value="education">Education & Tutoring</option>
                        <option value="consulting">Consulting & Coaching</option>
                        <option value="other">Other Service Business</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Tell us about your needs <span class="text-red-400">*</span></label>
                    <textarea name="message" rows="4" required class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500 focus:outline-none" placeholder="What problems are you trying to solve? How many clients do you serve?"></textarea>
                </div>
                
                <p class="text-xs text-gray-400">
                    <span class="text-red-400">*</span> Required fields
                </p>
                
                <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-yellow-500 text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all">
                    Get Started
                </button>
            </form>
            
            <div id="successMessage" class="hidden mt-4 p-4 bg-green-500/20 text-green-400 rounded-lg border border-green-500/30">
                <p class="font-semibold">Thank you! We'll be in touch within 24 hours.</p>
            </div>
        </div>
    </div>

    <script>
        // Mobile-friendly smooth scrolling
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                const offset = 80; // Navbar height
                const targetPosition = section.offsetTop - offset;
                
                // Use scrollIntoView for better mobile support
                section.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
                
                // Fallback for older browsers
                if (!('scrollBehavior' in document.documentElement.style)) {
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            }
        }

        // Detect if device is mobile
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
        }

        // Modal functions with mobile fixes
        function openContactModal() {
            const modal = document.getElementById('contactModal');
            modal.classList.add('show');
            
            // Don't lock body scroll on mobile
            if (!isMobile()) {
                document.body.classList.add('modal-open');
            }
            
            // Focus management for accessibility
            const firstInput = modal.querySelector('input');
            if (firstInput) {
                setTimeout(() => firstInput.focus(), 100);
            }
        }

        function closeModal() {
            const modal = document.getElementById('contactModal');
            modal.classList.remove('show');
            document.body.classList.remove('modal-open');
            
            // Reset form
            document.getElementById('contactForm').reset();
        }

        // ROI Calculator
        function calculateROI() {
            const clients = document.getElementById('clientCount').value || 0;
            const fee = document.getElementById('monthlyFee').value || 0;
            const revenue = clients * fee;
            document.getElementById('revenueDisplay').textContent = '$' + revenue.toLocaleString();
        }

        // Form submission with EmailJS
        function handleSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const templateParams = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                email: formData.get('email'),
                phone: formData.get('phone') || 'Not provided',
                businessType: formData.get('businessType'),
                message: formData.get('message'),
                to_name: 'Josh Lerner',
                from_name: formData.get('firstName') + ' ' + formData.get('lastName'),
                reply_to: formData.get('email')
            };
            
            // Replace these with your actual EmailJS service and template IDs
            emailjs.send('service_udp7mz5', 'template_1whn1gz', templateParams)
                .then(() => {
                    document.getElementById('contactForm').style.display = 'none';
                    document.getElementById('successMessage').classList.remove('hidden');
                    
                    setTimeout(() => {
                        closeModal();
                        document.getElementById('contactForm').style.display = 'block';
                        document.getElementById('successMessage').classList.add('hidden');
                        event.target.reset();
                    }, 3000);
                })
                .catch((error) => {
                    alert('Failed to send message. Please try again or contact us directly.');
                    console.error('EmailJS error:', error);
                });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
            
            // Fix iOS scroll issues
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                document.body.style.cursor = 'pointer';
                document.body.style.webkitTouchCallout = 'none';
                
                // Ensure body is scrollable
                document.body.style.position = 'relative';
                document.body.style.overflow = 'auto';
                document.documentElement.style.overflow = 'auto';
            }
            
            // Add touch-friendly click handlers
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('href').substring(1);
                    scrollToSection(sectionId);
                });
            });
            
            // Improve touch response
            if ('ontouchstart' in window) {
                document.querySelectorAll('button, a, .industry-badge').forEach(element => {
                    element.addEventListener('touchstart', function() {
                        this.style.opacity = '0.7';
                    });
                    element.addEventListener('touchend', function() {
                        this.style.opacity = '1';
                    });
                });
            }
            
            // Prevent overscroll on iOS
            let startY = 0;
            document.addEventListener('touchstart', function(e) {
                startY = e.touches[0].pageY;
            }, { passive: true });
            
            document.addEventListener('touchmove', function(e) {
                const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                const clientHeight = document.documentElement.clientHeight;
                const scrollHeight = document.documentElement.scrollHeight;
                const isTop = scrollTop === 0;
                const isBottom = scrollTop + clientHeight >= scrollHeight;
                const isUp = e.touches[0].pageY > startY;
                const isDown = e.touches[0].pageY < startY;
                
                if ((isTop && isUp) || (isBottom && isDown)) {
                    if (e.cancelable) {
                        e.preventDefault();
                    }
                }
            }, { passive: false });
        });

        // Close modal when clicking outside
        document.getElementById('contactModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Handle escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('contactModal').classList.contains('show')) {
                closeModal();
            }
        });

        // Prevent scroll issues on iOS
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            document.addEventListener('touchmove', function(e) {
                if (document.getElementById('contactModal').classList.contains('show')) {
                    const modalContent = document.querySelector('.modal-content');
                    if (!modalContent.contains(e.target)) {
                        e.preventDefault();
                    }
                }
            }, { passive: false });
        }
    </script>

    <!-- Demo App Script -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Demo accounts - updated with ClockWork branding and Josh Lerner as owner
        const demoAccounts = {
            'john.client@example.com': { 
                password: 'password123', 
                roles: ['client'], 
                name: 'John Anderson',
                id: 'client_001',
                specialistIds: ['specialist_001', 'specialist_002']
            },
            'sarah.specialist@clockwork.com': { 
                password: 'specialist123', 
                roles: ['specialist'], 
                name: 'Dr. Sarah Mitchell',
                id: 'specialist_001',
                clientIds: ['client_001']
            },
            'mike.specialist@clockwork.com': { 
                password: 'specialist123', 
                roles: ['specialist'], 
                name: 'Dr. Mike Johnson',
                id: 'specialist_002',
                clientIds: ['client_001']
            },
            'admin@clockwork.com': { 
                password: 'admin123', 
                roles: ['admin', 'specialist'], 
                name: 'Admin User',
                id: 'admin_001',
                clientIds: []
            },
            'owner@clockwork.com': { 
                password: 'owner123', 
                roles: ['owner', 'admin', 'specialist'], 
                name: 'Josh Lerner',
                id: 'owner_001',
                clientIds: []
            },
            'engineer@clockwork.com': { 
                password: 'engineer123', 
                roles: ['engineer', 'admin'], 
                name: 'Technical Admin',
                id: 'engineer_001'
            }
        };

        // Initialize demo data
        const initDemoData = () => {
            return {
                measurements: [
                    { 
                        id: 1, 
                        date: '2024-01-15', 
                        weight: 165, 
                        bodyFat: 18.2, 
                        bmr: 1650, 
                        bloodPressure: '120/80', 
                        clientId: 'client_001',
                        circumference: {
                            neck: 15.5,
                            shoulders: 45,
                            chest: 42,
                            upperArm: 14,
                            lowerArm: 11,
                            waist: 34,
                            hips: 40,
                            upperThigh: 24,
                            calf: 15
                        },
                        caliper: {
                            chest: 10,
                            abdominal: 15,
                            thigh: 12,
                            bicep: 8,
                            tricep: 10,
                            subscapular: 12,
                            suprailiac: 14,
                            lowerBack: 11,
                            calf: 9
                        }
                    },
                    { 
                        id: 2, 
                        date: '2024-02-14', 
                        weight: 163, 
                        bodyFat: 17.8, 
                        bmr: 1635, 
                        bloodPressure: '118/78', 
                        clientId: 'client_001',
                        circumference: {
                            neck: 15.3,
                            shoulders: 44.5,
                            chest: 41.5,
                            upperArm: 13.8,
                            lowerArm: 10.9,
                            waist: 33,
                            hips: 39.5,
                            upperThigh: 23.5,
                            calf: 14.8
                        },
                        caliper: {
                            chest: 9,
                            abdominal: 14,
                            thigh: 11,
                            bicep: 7,
                            tricep: 9,
                            subscapular: 11,
                            suprailiac: 13,
                            lowerBack: 10,
                            calf: 8
                        }
                    }
                ],
                workouts: [
                    {
                        id: 1,
                        name: 'Upper Body Strength',
                        clientId: 'client_001',
                        assignedBy: 'specialist_001',
                        exerciseImage: null,
                        youtubeLink: 'https://www.youtube.com/watch?v=example',
                        exercises: [
                            { 
                                id: 1, 
                                name: 'Push-ups', 
                                sets: 3, 
                                reps: 15, 
                                weight: 0,
                                actualSets: 3,
                                actualReps: 15,
                                actualWeight: 0,
                                painLevel: 1,
                                specialistNote: 'Focus on proper form'
                            },
                            { 
                                id: 2, 
                                name: 'Pull-ups', 
                                sets: 3, 
                                reps: 8, 
                                weight: 0,
                                actualSets: 3,
                                actualReps: 6,
                                actualWeight: 0,
                                painLevel: 2,
                                specialistNote: 'Use assistance band if needed'
                            }
                        ],
                        completed: true,
                        moodFeedback: 4,
                        notes: 'Felt good overall, slight shoulder discomfort',
                        completedDate: '2024-02-15'
                    }
                ],
                nutrition: {
                    clientId: 'client_001',
                    assignedBy: 'specialist_001',
                    protein: { target: 165, current: 155 },
                    carbs: { target: 200, current: 180 },
                    fat: { target: 60, current: 58 },
                    calories: { target: 2000, current: 1890 },
                    mealPlan: {
                        breakfast: 'Oatmeal with berries and protein powder',
                        lunch: 'Grilled chicken salad with quinoa',
                        dinner: 'Salmon with vegetables and sweet potato'
                    }
                },
                goals: [
                    { id: 1, name: 'Weight Loss Goal', target: 155, current: 163, deadline: '2024-06-30', clientId: 'client_001', assignedBy: 'specialist_001' },
                    { id: 2, name: 'Body Fat Reduction', target: 15, current: 17.8, deadline: '2024-08-30', clientId: 'client_001', assignedBy: 'specialist_001' }
                ],
                tests: [
                    { id: 1, name: 'Body Composition Analysis', date: '2024-01-15', results: 'Body fat: 18.2%, Muscle mass: 142lbs, Water: 58%', clientId: 'client_001', performedBy: 'specialist_001' },
                    { id: 2, name: 'VO2 Max Test', date: '2024-02-01', results: 'VO2 Max: 45 ml/kg/min - Above average for age group', clientId: 'client_001', performedBy: 'specialist_002' }
                ]
            };
        };

        // ClockWork Logo Component
        const ClockWorkLogo = ({ size = 'large' }) => {
            const [logoUrl, setLogoUrl] = useState(() => {
                try {
                    return localStorage.getItem('clockworkLogo') || null;
                } catch (error) {
                    console.error('Error loading logo:', error);
                    return null;
                }
            });
            const logoSize = size === 'large' ? 80 : 40;
            const fontSize = size === 'large' ? 'text-3xl' : 'text-lg';
            
            const handleLogoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        try {
                            setLogoUrl(reader.result);
                            localStorage.setItem('clockworkLogo', reader.result);
                        } catch (error) {
                            console.error('Error saving logo:', error);
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            return (
                <div className={`clockwork-logo ${size === 'small' ? 'small' : ''}`}>
                    <div className="logo-icon" style={{ width: logoSize, height: logoSize }}>
                        {logoUrl ? (
                            <img 
                                src={logoUrl} 
                                alt="ClockWork Logo" 
                                style={{ 
                                    width: '100%', 
                                    height: '100%', 
                                    objectFit: 'contain',
                                    borderRadius: '50%',
                                    position: 'relative',
                                    zIndex: 2
                                }}
                            />
                        ) : null}
                        {size === 'large' && (
                            <input
                                type="file"
                                accept="image/*"
                                onChange={handleLogoUpload}
                                style={{
                                    position: 'absolute',
                                    top: 0,
                                    left: 0,
                                    width: '100%',
                                    height: '100%',
                                    opacity: 0,
                                    cursor: 'pointer',
                                    zIndex: 3
                                }}
                                title="Click to upload logo"
                            />
                        )}
                    </div>
                    <div>
                        <div className={`font-bold ${fontSize} logo-text-primary gradient-text-dark`}>
                            CLOCKWORK
                        </div>
                        <div className={`${size === 'large' ? 'text-xs' : 'text-xxs'} tracking-wider logo-text-secondary`}>
                            UNIVERSAL BUSINESS PLATFORM
                        </div>
                    </div>
                </div>
            );
        };

        // Error Boundary Component
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }

            componentDidCatch(error, errorInfo) {
                console.error('Error caught by boundary:', error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen flex items-center justify-center bg-slate-900">
                            <div className="text-center">
                                <h2 className="text-2xl font-bold text-red-400 mb-4">Something went wrong</h2>
                                <p className="text-gray-400 mb-4">Please refresh the page or try again.</p>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="clockwork-button"
                                >
                                    Refresh Page
                                </button>
                            </div>
                        </div>
                    );
                }

                return this.props.children;
            }
        }

        // Main App Component
        const App = () => {
            const [currentUser, setCurrentUser] = useState(() => {
                try {
                    const saved = sessionStorage.getItem('clockworkUser');
                    return saved ? JSON.parse(saved) : null;
                } catch (error) {
                    console.error('Error loading user:', error);
                    return null;
                }
            });

            const [activeTab, setActiveTab] = useState('dashboard');
            const [clientData, setClientData] = useState(() => {
                try {
                    const saved = localStorage.getItem('clockworkClientData');
                    return saved ? JSON.parse(saved) : initDemoData();
                } catch (error) {
                    console.error('Error loading client data:', error);
                    return initDemoData();
                }
            });

            const [selectedClient, setSelectedClient] = useState(null);
            const [messages, setMessages] = useState(() => {
                try {
                    const saved = localStorage.getItem('clockworkMessages');
                    return saved ? JSON.parse(saved) : {
                        // Initialize with some demo messages
                        'client_001-specialist_001': [
                            {
                                id: 1,
                                text: 'Hi John! How are you feeling after yesterday\'s workout?',
                                sender: 'specialist_001',
                                senderName: 'Dr. Sarah Mitchell',
                                timestamp: new Date(Date.now() - 86400000).toISOString(),
                                read: true
                            },
                            {
                                id: 2,
                                text: 'Hi Dr. Mitchell! I\'m feeling great, just a bit sore in my shoulders.',
                                sender: 'client_001',
                                senderName: 'John Anderson',
                                timestamp: new Date(Date.now() - 85000000).toISOString(),
                                read: true
                            }
                        ]
                    };
                } catch (error) {
                    console.error('Error loading messages:', error);
                    return {};
                }
            });

            const [allUsers, setAllUsers] = useState(() => {
                try {
                    const saved = localStorage.getItem('clockworkAllUsers');
                    if (saved) {
                        return JSON.parse(saved);
                    }
                    return Object.entries(demoAccounts).map(([email, data]) => ({ 
                        ...data, 
                        email,
                        online: Math.random() > 0.5
                    }));
                } catch (error) {
                    console.error('Error loading users:', error);
                    return Object.entries(demoAccounts).map(([email, data]) => ({ 
                        ...data, 
                        email,
                        online: Math.random() > 0.5
                    }));
                }
            });

            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            // Save data to storage whenever it changes
            useEffect(() => {
                try {
                    if (currentUser) {
                        sessionStorage.setItem('clockworkUser', JSON.stringify(currentUser));
                    } else {
                        sessionStorage.removeItem('clockworkUser');
                    }
                } catch (error) {
                    console.error('Error saving user:', error);
                }
            }, [currentUser]);

            useEffect(() => {
                try {
                    localStorage.setItem('clockworkClientData', JSON.stringify(clientData));
                } catch (error) {
                    console.error('Error saving client data:', error);
                }
            }, [clientData]);

            useEffect(() => {
                try {
                    localStorage.setItem('clockworkMessages', JSON.stringify(messages));
                } catch (error) {
                    console.error('Error saving messages:', error);
                }
            }, [messages]);

            useEffect(() => {
                try {
                    localStorage.setItem('clockworkAllUsers', JSON.stringify(allUsers));
                } catch (error) {
                    console.error('Error saving users:', error);
                }
            }, [allUsers]);

            // Helper functions
            const hasRole = (role) => currentUser?.roles?.includes(role);
            const hasAnyRole = (...roles) => roles.some(role => hasRole(role));

            // Get clients for current specialist/admin/owner
            const getMyClients = () => {
                if (hasRole('owner') || hasRole('admin')) {
                    return allUsers.filter(u => u.roles.includes('client'));
                } else if (hasRole('specialist')) {
                    return allUsers.filter(u => 
                        u.roles.includes('client') && 
                        currentUser.clientIds?.includes(u.id)
                    );
                }
                return [];
            };

            // Clear error after 5 seconds
            useEffect(() => {
                if (error) {
                    const timer = setTimeout(() => setError(null), 5000);
                    return () => clearTimeout(timer);
                }
            }, [error]);

            // Function to handle logout and reset data
            const handleLogout = () => {
                try {
                    // Clear all demo data
                    localStorage.removeItem('clockworkClientData');
                    localStorage.removeItem('clockworkMessages');
                    localStorage.removeItem('clockworkAllUsers');
                    localStorage.removeItem('clockworkLogo');
                    sessionStorage.removeItem('clockworkUser');
                    
                    // Reset to initial state
                    setClientData(initDemoData());
                    setMessages({
                        'client_001-specialist_001': [
                            {
                                id: 1,
                                text: 'Hi John! How are you feeling after yesterday\'s workout?',
                                sender: 'specialist_001',
                                senderName: 'Dr. Sarah Mitchell',
                                timestamp: new Date(Date.now() - 86400000).toISOString(),
                                read: true
                            },
                            {
                                id: 2,
                                text: 'Hi Dr. Mitchell! I\'m feeling great, just a bit sore in my shoulders.',
                                sender: 'client_001',
                                senderName: 'John Anderson',
                                timestamp: new Date(Date.now() - 85000000).toISOString(),
                                read: true
                            }
                        ]
                    });
                    setAllUsers(Object.entries(demoAccounts).map(([email, data]) => ({ 
                        ...data, 
                        email,
                        online: Math.random() > 0.5
                    })));
                    setCurrentUser(null);
                    setSelectedClient(null);
                    setActiveTab('dashboard');
                } catch (error) {
                    console.error('Error during logout:', error);
                }
            };

            // Login Component
            const LoginForm = () => {
                const [email, setEmail] = useState('');
                const [password, setPassword] = useState('');
                const [loginError, setLoginError] = useState('');
                const [isSignup, setIsSignup] = useState(false);
                const [name, setName] = useState('');
                const [isLoading, setIsLoading] = useState(false);
                const [showResetPassword, setShowResetPassword] = useState(false);
                const [resetEmail, setResetEmail] = useState('');
                const [resetMessage, setResetMessage] = useState('');

                const handleAuth = async (e) => {
                    e.preventDefault();
                    setIsLoading(true);
                    setLoginError('');
                    
                    try {
                        if (isSignup) {
                            await new Promise(resolve => setTimeout(resolve, 1000));
                            
                            // Check if email already exists
                            const emailExists = allUsers.some(u => u.email === email) || Object.keys(demoAccounts).includes(email);
                            if (emailExists) {
                                setLoginError('Email already exists. Please use a different email or login.');
                                return;
                            }
                            
                            const newUser = {
                                id: `client_${Date.now()}`,
                                email,
                                password,
                                name: name || email.split('@')[0],
                                roles: ['client'],
                                specialistIds: [],
                                clientIds: [],
                                online: true
                            };
                            
                            // Add to allUsers
                            setAllUsers(prev => [...prev, newUser]);
                            
                            // Set as current user
                            setCurrentUser(newUser);
                        } else {
                            await new Promise(resolve => setTimeout(resolve, 800));
                            
                            // Check demo accounts first
                            const demoUser = demoAccounts[email];
                            if (demoUser && demoUser.password === password) {
                                setCurrentUser({ ...demoUser, email });
                            } else {
                                // Check dynamically created users
                                const dynamicUser = allUsers.find(u => u.email === email && u.password === password);
                                if (dynamicUser) {
                                    setCurrentUser(dynamicUser);
                                } else {
                                    setLoginError('Invalid credentials. Please try again.');
                                }
                            }
                        }
                    } catch (error) {
                        setLoginError('An error occurred. Please try again.');
                        console.error('Auth error:', error);
                    } finally {
                        setIsLoading(false);
                    }
                };

                const handlePasswordReset = async (e) => {
                    e.preventDefault();
                    setIsLoading(true);
                    setResetMessage('');
                    
                    try {
                        await new Promise(resolve => setTimeout(resolve, 1500));
                        
                        // Check if email exists in demo accounts
                        const userExists = Object.keys(demoAccounts).includes(resetEmail) || 
                                         allUsers.some(u => u.email === resetEmail);
                        
                        if (userExists) {
                            setResetMessage('Password reset link sent to your email! Check your inbox.');
                            setTimeout(() => {
                                setShowResetPassword(false);
                                setResetEmail('');
                                setResetMessage('');
                            }, 3000);
                        } else {
                            setResetMessage('Email not found. Please check and try again.');
                        }
                    } catch (error) {
                        setResetMessage('Error sending reset link. Please try again.');
                    } finally {
                        setIsLoading(false);
                    }
                };

                if (showResetPassword) {
                    return (
                        <div className="clockwork-gradient flex items-center justify-center min-h-screen p-4">
                            <div className="lightning-container">
                                <div className="lightning-bolt"></div>
                                <div className="lightning-bolt lightning-bolt-thick"></div>
                                <div className="lightning-bolt"></div>
                            </div>
                            <div className="login-card">
                                <ClockWorkLogo size="large" />
                                <h2 className="text-2xl font-bold text-center mb-2 text-white">Reset Password</h2>
                                <p className="text-gray-400 text-center mb-6">
                                    Enter your email address and we'll send you a link to reset your password.
                                </p>
                                
                                <form onSubmit={handlePasswordReset}>
                                    <div className="form-group">
                                        <label className="form-label">Email Address</label>
                                        <input
                                            type="email"
                                            value={resetEmail}
                                            onChange={(e) => setResetEmail(e.target.value)}
                                            className="clockwork-input"
                                            placeholder="Enter your email"
                                            required
                                        />
                                    </div>
                                    
                                    {resetMessage && (
                                        <div className={resetMessage.includes('sent') ? 'success-message' : 'error-message'}>
                                            {resetMessage}
                                        </div>
                                    )}
                                    
                                    <button 
                                        type="submit" 
                                        className="clockwork-button login flex items-center justify-center gap-2"
                                        disabled={isLoading}
                                    >
                                        {isLoading && <div className="loading-spinner"></div>}
                                        Send Reset Link
                                    </button>
                                </form>
                                
                                <div className="text-center mt-4">
                                    <button
                                        onClick={() => {
                                            setShowResetPassword(false);
                                            setResetEmail('');
                                            setResetMessage('');
                                        }}
                                        className="text-blue-400 hover:text-blue-300"
                                    >
                                        ‚Üê Back to Login
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="clockwork-gradient flex items-center justify-center min-h-screen p-4">
                        <div className="lightning-container">
                            <div className="lightning-bolt"></div>
                            <div className="lightning-bolt lightning-bolt-thick"></div>
                            <div className="lightning-bolt"></div>
                            <div className="lightning-bolt lightning-bolt-thick"></div>
                            <div className="lightning-bolt"></div>
                        </div>
                        <div className="login-card">
                            <ClockWorkLogo size="large" />
                            <p className="brand-tagline">Universal Business Platform</p>
                            
                            <div className="login-toggle">
                                <button
                                    onClick={() => setIsSignup(false)}
                                    className={!isSignup ? 'active' : ''}
                                >
                                    Login
                                </button>
                                <button
                                    onClick={() => setIsSignup(true)}
                                    className={isSignup ? 'active' : ''}
                                >
                                    Sign Up
                                </button>
                            </div>
                            
                            <form onSubmit={handleAuth}>
                                {isSignup && (
                                    <div className="form-group">
                                        <label className="form-label">Full Name</label>
                                        <input
                                            type="text"
                                            value={name}
                                            onChange={(e) => setName(e.target.value)}
                                            className="clockwork-input"
                                            placeholder="Enter your full name"
                                            required
                                        />
                                    </div>
                                )}
                                
                                <div className="form-group">
                                    <label className="form-label">Email Address</label>
                                    <input
                                        type="email"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        className="clockwork-input"
                                        placeholder="Enter your email"
                                        required
                                    />
                                </div>
                                
                                <div className="form-group">
                                    <label className="form-label">Password</label>
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        className="clockwork-input"
                                        placeholder="Enter your password"
                                        required
                                    />
                                </div>
                                
                                {loginError && (
                                    <div className="error-message">{loginError}</div>
                                )}
                                
                                <button 
                                    type="submit" 
                                    className="clockwork-button login flex items-center justify-center gap-2"
                                    disabled={isLoading}
                                >
                                    {isLoading && <div className="loading-spinner"></div>}
                                    {isSignup ? 'Start Your Journey' : 'Sign In'}
                                </button>
                            </form>
                            
                            {!isSignup && (
                                <div className="forgot-password" style={{ textAlign: 'center', marginTop: '1.5rem' }}>
                                    <button 
                                        onClick={() => setShowResetPassword(true)}
                                        style={{ 
                                            color: '#60a5fa', 
                                            textDecoration: 'none', 
                                            fontWeight: 500,
                                            background: 'none',
                                            border: 'none',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Forgot Password?
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            // Navigation Component
            const Navigation = () => {
                const tabs = [
                    { id: 'dashboard', label: 'Dashboard', icon: 'üìä' },
                    { id: 'measurements', label: 'Measurements', icon: 'üìè' },
                    { id: 'nutrition', label: 'Nutrition', icon: 'ü•ó' },
                    { id: 'workouts', label: 'Workouts', icon: 'üí™' },
                    { id: 'goals', label: 'Goals', icon: 'üéØ' },
                    { id: 'chat', label: 'Chat', icon: 'üí¨' },
                    { id: 'reports', label: 'Reports', icon: 'üìà' }
                ];

                if (hasAnyRole('admin', 'owner')) {
                    tabs.push({ id: 'users', label: 'Users', icon: 'üë•' });
                }

                if (hasAnyRole('specialist', 'admin', 'owner')) {
                    tabs.push({ id: 'tests', label: 'Tests', icon: 'üß™' });
                }

                if (hasAnyRole('engineer', 'owner')) {
                    tabs.push({ id: 'engineer', label: 'Engineer', icon: 'üîß' });
                }

                const exportMyData = () => {
                    try {
                        let exportContent = "CLOCKWORK PLATFORM - MY DATA EXPORT\n";
                        exportContent += "===================================\n\n";
                        
                        exportContent += "USER INFORMATION\n";
                        exportContent += "----------------\n";
                        exportContent += `Name: ${currentUser.name}\n`;
                        exportContent += `Email: ${currentUser.email}\n`;
                        exportContent += `Roles: ${currentUser.roles.join(', ')}\n`;
                        exportContent += `Export Date: ${new Date().toISOString()}\n\n`;
                        
                        const myMeasurements = clientData.measurements.filter(m => m.clientId === currentUser.id);
                        exportContent += "MEASUREMENTS\n";
                        exportContent += "------------\n";
                        myMeasurements.forEach(m => {
                            exportContent += `Date: ${m.date} | Weight: ${m.weight}lbs | Body Fat: ${m.bodyFat}% | BMR: ${m.bmr} | BP: ${m.bloodPressure}\n`;
                        });
                        exportContent += "\n";
                        
                        const myWorkouts = clientData.workouts.filter(w => w.clientId === currentUser.id);
                        exportContent += "WORKOUTS\n";
                        exportContent += "--------\n";
                        myWorkouts.forEach(w => {
                            exportContent += `${w.name} - ${w.completed ? 'Completed' : 'Pending'}`;
                            if (w.moodFeedback) exportContent += ` - Mood: ${w.moodFeedback}/5`;
                            if (w.completedDate) exportContent += ` - Date: ${w.completedDate}`;
                            exportContent += "\n";
                        });
                        exportContent += "\n";
                        
                        const myGoals = clientData.goals.filter(g => g.clientId === currentUser.id);
                        exportContent += "GOALS\n";
                        exportContent += "-----\n";
                        myGoals.forEach(g => {
                            const progress = Math.round((g.current / g.target) * 100);
                            exportContent += `${g.name} - Progress: ${g.current}/${g.target} (${progress}%) - Deadline: ${g.deadline}\n`;
                        });
                        exportContent += "\n";
                        
                        const myTests = clientData.tests.filter(t => t.clientId === currentUser.id);
                        exportContent += "TESTS\n";
                        exportContent += "-----\n";
                        myTests.forEach(t => {
                            exportContent += `${t.name} - Date: ${t.date}\n`;
                            exportContent += `Results: ${t.results}\n\n`;
                        });
                        
                        const blob = new Blob([exportContent], { type: 'text/plain;charset=utf-8;' });
                        const link = document.createElement('a');
                        const url = URL.createObjectURL(blob);
                        link.setAttribute('href', url);
                        link.setAttribute('download', `my-clockwork-data-${new Date().toISOString().split('T')[0]}.txt`);
                        link.style.visibility = 'hidden';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error('Error exporting data:', error);
                        setError('Error exporting data. Please try again.');
                    }
                };

                return (
                    <nav className="clockwork-card mb-6 px-6 py-4">
                        <div className="flex justify-between items-center mb-4">
                            <ClockWorkLogo size="small" />
                            <div className="flex items-center gap-4">
                                <div className="flex gap-2">
                                    {currentUser.roles.map(role => (
                                        <span key={role} className={`clockwork-badge badge-${role}`}>
                                            {role}
                                        </span>
                                    ))}
                                </div>
                                <span className="text-gray-300">{currentUser.name}</span>
                                <button 
                                    onClick={exportMyData}
                                    className="clockwork-button-secondary"
                                >
                                    üìä Export My Data
                                </button>
                                <button 
                                    onClick={handleLogout}
                                    className="text-gray-400 hover:text-gray-200"
                                >
                                    Logout
                                </button>
                            </div>
                        </div>
                        
                        <div className="flex gap-2 overflow-x-auto">
                            {tabs.map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`clockwork-tab ${activeTab === tab.id ? 'active' : ''}`}
                                >
                                    <span className="mr-2">{tab.icon}</span>
                                    {tab.label}
                                </button>
                            ))}
                        </div>
                    </nav>
                );
            };

            // Dashboard Component
            const Dashboard = () => {
                const currentClientId = hasRole('client') ? currentUser.id : selectedClient?.id;
                const displayName = hasRole('client') ? currentUser.name : selectedClient?.name || 'Select a client';
                
                const latestMeasurement = clientData.measurements
                    .filter(m => hasRole('client') ? m.clientId === currentUser.id : (selectedClient ? m.clientId === selectedClient.id : false))
                    .slice(-1)[0] || {};
                
                const chartRef = useRef(null);
                const chartInstance = useRef(null);
                const [selectedMetrics, setSelectedMetrics] = useState(['weight']);
                const [showCircumferenceChart, setShowCircumferenceChart] = useState(false);
                const circumferenceChartRef = useRef(null);
                const circumferenceChartInstance = useRef(null);

                const myWorkouts = clientData.workouts.filter(w => 
                    hasRole('client') ? w.clientId === currentUser.id : (selectedClient ? w.clientId === selectedClient.id : false)
                );

                const myGoals = clientData.goals.filter(g => 
                    hasRole('client') ? g.clientId === currentUser.id : (selectedClient ? g.clientId === selectedClient.id : false)
                );

                const getAveragePainLevel = () => {
                    const completedWorkouts = myWorkouts.filter(w => w.completed);
                    if (completedWorkouts.length === 0) return 0;
                    
                    let totalPain = 0;
                    let exerciseCount = 0;
                    
                    completedWorkouts.forEach(workout => {
                        workout.exercises.forEach(exercise => {
                            if (exercise.painLevel !== undefined) {
                                totalPain += exercise.painLevel;
                                exerciseCount++;
                            }
                        });
                    });
                    
                    return exerciseCount > 0 ? (totalPain / exerciseCount).toFixed(1) : 0;
                };

                const getRecentMoodFeedback = () => {
                    const completedWorkouts = myWorkouts
                        .filter(w => w.completed && w.moodFeedback)
                        .sort((a, b) => new Date(b.completedDate || 0) - new Date(a.completedDate || 0))
                        .slice(0, 5);
                    
                    return completedWorkouts;
                };

                useEffect(() => {
                    if (chartRef.current && (selectedClient || hasRole('client'))) {
                        if (chartInstance.current) {
                            chartInstance.current.destroy();
                        }

                        const relevantMeasurements = clientData.measurements.filter(m => 
                            hasRole('client') ? m.clientId === currentUser.id : m.clientId === selectedClient?.id
                        );

                        const datasets = [];
                        const colors = {
                            weight: '#3b82f6',
                            bodyFat: '#fbbf24',
                            bmr: '#10b981'
                        };

                        if (selectedMetrics.includes('weight')) {
                            datasets.push({
                                label: 'Weight (lbs)',
                                data: relevantMeasurements.map(m => m.weight),
                                borderColor: colors.weight,
                                backgroundColor: `${colors.weight}20`,
                                tension: 0.4,
                                yAxisID: 'y-weight'
                            });
                        }

                        if (selectedMetrics.includes('bodyFat')) {
                            datasets.push({
                                label: 'Body Fat (%)',
                                data: relevantMeasurements.map(m => m.bodyFat),
                                borderColor: colors.bodyFat,
                                backgroundColor: `${colors.bodyFat}20`,
                                tension: 0.4,
                                yAxisID: 'y-bodyfat'
                            });
                        }

                        if (selectedMetrics.includes('bmr')) {
                            datasets.push({
                                label: 'BMR (cal)',
                                data: relevantMeasurements.map(m => m.bmr),
                                borderColor: colors.bmr,
                                backgroundColor: `${colors.bmr}20`,
                                tension: 0.4,
                                yAxisID: 'y-bmr'
                            });
                        }

                        const scales = {};
                        if (selectedMetrics.includes('weight')) {
                            scales['y-weight'] = {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Weight (lbs)',
                                    color: '#e2e8f0'
                                },
                                ticks: {
                                    color: '#94a3b8'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            };
                        }
                        if (selectedMetrics.includes('bodyFat')) {
                            scales['y-bodyfat'] = {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false,
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                title: {
                                    display: true,
                                    text: 'Body Fat (%)',
                                    color: '#e2e8f0'
                                },
                                ticks: {
                                    color: '#94a3b8'
                                }
                            };
                        }
                        if (selectedMetrics.includes('bmr')) {
                            scales['y-bmr'] = {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                grid: {
                                    drawOnChartArea: false,
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                title: {
                                    display: true,
                                    text: 'BMR (cal/day)',
                                    color: '#e2e8f0'
                                },
                                ticks: {
                                    color: '#94a3b8'
                                }
                            };
                        }

                        const ctx = chartRef.current.getContext('2d');
                        chartInstance.current = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: relevantMeasurements.map(m => m.date),
                                datasets: datasets
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: scales,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Health Metrics Over Time',
                                        color: '#e2e8f0'
                                    },
                                    legend: {
                                        labels: {
                                            color: '#e2e8f0'
                                        }
                                    }
                                }
                            }
                        });
                    }

                    return () => {
                        if (chartInstance.current) {
                            chartInstance.current.destroy();
                        }
                    };
                }, [clientData.measurements, selectedMetrics, currentUser.id, selectedClient]);

                useEffect(() => {
                    if (circumferenceChartRef.current && showCircumferenceChart && (selectedClient || hasRole('client'))) {
                        if (circumferenceChartInstance.current) {
                            circumferenceChartInstance.current.destroy();
                        }

                        const relevantMeasurements = clientData.measurements.filter(m => 
                            hasRole('client') ? m.clientId === currentUser.id : m.clientId === selectedClient?.id
                        ).filter(m => m.circumference);

                        if (relevantMeasurements.length > 0) {
                            const circumferenceKeys = Object.keys(relevantMeasurements[0].circumference);
                            const colors = ['#3b82f6', '#60a5fa', '#fbbf24', '#10b981', '#ef4444', '#8b5cf6', '#ec4899', '#06b6d4', '#84cc16'];
                            
                            const datasets = circumferenceKeys.map((key, index) => ({
                                label: key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1'),
                                data: relevantMeasurements.map(m => m.circumference?.[key] || 0),
                                borderColor: colors[index % colors.length],
                                backgroundColor: `${colors[index % colors.length]}20`,
                                tension: 0.4
                            }));

                            const ctx = circumferenceChartRef.current.getContext('2d');
                            circumferenceChartInstance.current = new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: relevantMeasurements.map(m => m.date),
                                    datasets: datasets
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Body Circumference Measurements (inches)',
                                            color: '#e2e8f0'
                                        },
                                        legend: {
                                            labels: {
                                                color: '#e2e8f0'
                                            }
                                        }
                                    },
                                    scales: {
                                        x: {
                                            ticks: {
                                                color: '#94a3b8'
                                            },
                                            grid: {
                                                color: 'rgba(255, 255, 255, 0.1)'
                                            }
                                        },
                                        y: {
                                            ticks: {
                                                color: '#94a3b8'
                                            },
                                            grid: {
                                                color: 'rgba(255, 255, 255, 0.1)'
                                            }
                                        }
                                    }
                                }
                            });
                        }
                    }

                    return () => {
                        if (circumferenceChartInstance.current) {
                            circumferenceChartInstance.current.destroy();
                        }
                    };
                }, [showCircumferenceChart, clientData.measurements, currentUser.id, selectedClient]);

                const toggleMetric = (metric) => {
                    setSelectedMetrics(prev => 
                        prev.includes(metric) 
                            ? prev.filter(m => m !== metric)
                            : [...prev, metric]
                    );
                };

                const recentMoods = getRecentMoodFeedback();
                const avgPainLevel = getAveragePainLevel();

                return (
                    <div className="space-y-6">
                        <div className="clockwork-card p-6">
                            <h2 className="text-2xl font-bold mb-2 text-white">
                                {hasRole('client') ? `Welcome back, ${currentUser.name}!` : `Dashboard - ${displayName}`}
                            </h2>
                            <p className="text-gray-400">
                                {hasRole('client') ? 'Your progress journey continues today' : 'Client overview'}
                            </p>
                            
                            {hasAnyRole('specialist', 'admin', 'owner') && (
                                <div className="mt-4">
                                    <select 
                                        onChange={(e) => setSelectedClient(allUsers.find(u => u.id === e.target.value))}
                                        className="clockwork-select max-w-xs"
                                        value={selectedClient?.id || ''}
                                    >
                                        <option value="">Select a client...</option>
                                        {getMyClients().map(client => (
                                            <option key={client.id} value={client.id}>{client.name}</option>
                                        ))}
                                    </select>
                                </div>
                            )}
                        </div>

                        {(hasRole('client') || selectedClient) && (
                            <>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <div className="stat-card">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-3xl">‚öñÔ∏è</span>
                                            <span className="text-2xl font-bold text-gray-200">{latestMeasurement.weight || '-'} lbs</span>
                                        </div>
                                        <p className="text-sm text-gray-400">Current Weight</p>
                                        <p className="text-xs text-gray-500">{latestMeasurement.date || 'No data'}</p>
                                    </div>

                                    <div className="stat-card">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-3xl">üî•</span>
                                            <span className="text-2xl font-bold text-orange-400">{latestMeasurement.bodyFat || '-'}%</span>
                                        </div>
                                        <p className="text-sm text-gray-400">Body Fat</p>
                                        <p className="text-xs text-gray-500">Current level</p>
                                    </div>

                                    <div className="stat-card">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-3xl">‚ù§Ô∏è</span>
                                            <span className="text-2xl font-bold text-red-400">{latestMeasurement.bloodPressure || '-'}</span>
                                        </div>
                                        <p className="text-sm text-gray-400">Blood Pressure</p>
                                        <p className="text-xs text-gray-500">{latestMeasurement.date || 'No data'}</p>
                                    </div>

                                    <div className="stat-card">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="text-3xl">üèÜ</span>
                                            <span className="text-2xl font-bold text-green-400">{myGoals.filter(g => g.current >= g.target).length}/{myGoals.length}</span>
                                        </div>
                                        <p className="text-sm text-gray-400">Goals Completed</p>
                                        <p className="text-xs text-gray-500">Keep it up!</p>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div className="pain-summary-card">
                                        <h3 className="text-lg font-semibold mb-4 flex items-center gap-2 text-white">
                                            <span>ü©π</span>
                                            Pain Level Summary
                                        </h3>
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-3xl font-bold text-orange-300">{avgPainLevel}</p>
                                                <p className="text-sm text-gray-300">Average Pain Level</p>
                                            </div>
                                            <div className="flex gap-1">
                                                {[0, 1, 2, 3, 4, 5].map(level => (
                                                    <div
                                                        key={level}
                                                        className={`pain-scale-btn pain-${level} ${
                                                            Math.round(avgPainLevel) === level ? 'selected' : ''
                                                        }`}
                                                        style={{ cursor: 'default' }}
                                                    >
                                                        {level}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                        <p className="text-xs text-gray-400 mt-3">
                                            Based on {myWorkouts.filter(w => w.completed).length} completed workouts
                                        </p>
                                    </div>

                                    <div className="mood-summary-card">
                                        <h3 className="text-lg font-semibold mb-4 flex items-center gap-2 text-white">
                                            <span>üòä</span>
                                            Workout Mood Tracker
                                        </h3>
                                        <div className="space-y-2">
                                            {recentMoods.length > 0 ? (
                                                recentMoods.map((workout, index) => (
                                                    <div key={workout.id} className="flex items-center justify-between">
                                                        <span className="text-sm text-gray-300">{workout.name}</span>
                                                        <span className="text-2xl">
                                                            {['üò¢', 'üòï', 'üòê', 'üòä', 'üòÅ'][workout.moodFeedback - 1]}
                                                        </span>
                                                    </div>
                                                ))
                                            ) : (
                                                <p className="text-sm text-gray-400">No mood feedback yet</p>
                                            )}
                                        </div>
                                        <p className="text-xs text-gray-400 mt-3">
                                            Recent workout mood feedback
                                        </p>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div className="clockwork-card p-6">
                                        <h3 className="text-lg font-semibold mb-4 text-white">üí™ Today's Workouts</h3>
                                        {myWorkouts.length > 0 ? myWorkouts.map(workout => (
                                            <div key={workout.id} className="bg-slate-800/50 rounded-xl p-4 mb-3 border border-white/10">
                                                <div className="flex justify-between items-center">
                                                    <div>
                                                        <h4 className="font-semibold text-white">{workout.name}</h4>
                                                        <p className="text-sm text-gray-400">
                                                            {workout.exercises.map(e => e.name).join(' ‚Ä¢ ')}
                                                        </p>
                                                    </div>
                                                    {workout.completed && (
                                                        <span className="bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-sm border border-green-500/30">
                                                            ‚úì Complete
                                                        </span>
                                                    )}
                                                </div>
                                                {workout.moodFeedback && (
                                                    <div className="mt-2 text-sm text-gray-400">
                                                        Mood: {['üò¢', 'üòï', 'üòê', 'üòä', 'üòÅ'][workout.moodFeedback - 1] || 'üòê'}
                                                    </div>
                                                )}
                                            </div>
                                        )) : (
                                            <p className="text-gray-500">No workouts assigned</p>
                                        )}
                                    </div>

                                    <div className="clockwork-card p-6">
                                        <h3 className="text-lg font-semibold mb-4 text-white">ü•ó Nutrition Today</h3>
                                        {clientData.nutrition && (clientData.nutrition.clientId === currentClientId) ? (
                                            <div className="space-y-3">
                                                <div>
                                                    <div className="flex justify-between mb-1">
                                                        <span className="text-sm text-gray-400">Protein</span>
                                                        <span className="text-sm font-semibold text-gray-200">{clientData.nutrition.protein.current}g / {clientData.nutrition.protein.target}g</span>
                                                    </div>
                                                    <div className="progress-bar">
                                                        <div className="progress-fill" style={{ width: `${(clientData.nutrition.protein.current / clientData.nutrition.protein.target) * 100}%` }}></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="flex justify-between mb-1">
                                                        <span className="text-sm text-gray-400">Carbs</span>
                                                        <span className="text-sm font-semibold text-gray-200">{clientData.nutrition.carbs.current}g / {clientData.nutrition.carbs.target}g</span>
                                                    </div>
                                                    <div className="progress-bar">
                                                        <div className="progress-fill" style={{ width: `${(clientData.nutrition.carbs.current / clientData.nutrition.carbs.target) * 100}%` }}></div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="flex justify-between mb-1">
                                                        <span className="text-sm text-gray-400">Fat</span>
                                                        <span className="text-sm font-semibold text-gray-200">{clientData.nutrition.fat.current}g / {clientData.nutrition.fat.target}g</span>
                                                    </div>
                                                    <div className="progress-bar">
                                                        <div className="progress-fill" style={{ width: `${(clientData.nutrition.fat.current / clientData.nutrition.fat.target) * 100}%` }}></div>
                                                    </div>
                                                </div>
                                                <div className="pt-3 border-t border-white/10">
                                                    <div className="flex justify-between">
                                                        <span className="text-sm font-medium text-gray-400">Calories</span>
                                                        <span className="text-sm font-bold text-blue-400">{clientData.nutrition.calories.current} / {clientData.nutrition.calories.target}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        ) : (
                                            <p className="text-gray-500">No nutrition plan assigned</p>
                                        )}
                                    </div>
                                </div>

                                <div className="clockwork-card p-6">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="text-lg font-semibold text-white">Progress Chart</h3>
                                        <div className="flex gap-2">
                                            <button
                                                onClick={() => toggleMetric('weight')}
                                                className={`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${
                                                    selectedMetrics.includes('weight') 
                                                        ? 'bg-blue-500 text-white' 
                                                        : 'bg-slate-700 text-gray-300'
                                                }`}
                                            >
                                                Weight
                                            </button>
                                            <button
                                                onClick={() => toggleMetric('bodyFat')}
                                                className={`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${
                                                    selectedMetrics.includes('bodyFat') 
                                                        ? 'bg-amber-500 text-white' 
                                                        : 'bg-slate-700 text-gray-300'
                                                }`}
                                            >
                                                Body Fat
                                            </button>
                                            <button
                                                onClick={() => toggleMetric('bmr')}
                                                className={`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${
                                                    selectedMetrics.includes('bmr') 
                                                        ? 'bg-green-500 text-white' 
                                                        : 'bg-slate-700 text-gray-300'
                                                }`}
                                            >
                                                BMR
                                            </button>
                                        </div>
                                    </div>
                                    <div className="h-64">
                                        <canvas ref={chartRef}></canvas>
                                    </div>
                                </div>

                                <div className="clockwork-card p-6">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="text-lg font-semibold text-white">Body Circumference Chart</h3>
                                        <button
                                            onClick={() => setShowCircumferenceChart(!showCircumferenceChart)}
                                            className="clockwork-button-secondary"
                                        >
                                            {showCircumferenceChart ? 'Hide' : 'Show'} Chart
                                        </button>
                                    </div>
                                    {showCircumferenceChart && (
                                        <div className="h-64">
                                            <canvas ref={circumferenceChartRef}></canvas>
                                        </div>
                                    )}
                                </div>
                            </>
                        )}
                    </div>
                );
            };

            // Chat Component
            const ChatComponent = () => {
                const [selectedChat, setSelectedChat] = useState(null);
                const [messageText, setMessageText] = useState('');
                const [searchQuery, setSearchQuery] = useState('');
                const [typing, setTyping] = useState({});
                const [showZoomScheduler, setShowZoomScheduler] = useState(false);
                const [zoomForm, setZoomForm] = useState({
                    date: new Date(Date.now() + 86400000).toISOString().split('T')[0], // Tomorrow
                    time: '15:00',
                    duration: '60',
                    topic: ''
                });
                const messagesEndRef = useRef(null);

                const getChatPartners = () => {
                    if (hasRole('client')) {
                        return allUsers.filter(u => 
                            u.id !== currentUser.id && (
                                (u.roles.includes('specialist') && (
                                    currentUser.specialistIds?.includes(u.id) || 
                                    u.clientIds?.includes(currentUser.id)
                                )) ||
                                u.roles.includes('admin') || 
                                u.roles.includes('owner')
                            )
                        );
                    } else if (hasAnyRole('owner', 'admin')) {
                        return allUsers.filter(u => u.id !== currentUser.id);
                    } else if (hasRole('specialist')) {
                        const assignedClients = allUsers.filter(u =>
                            u.id !== currentUser.id &&
                            u.roles.includes('client') &&
                            (currentUser.clientIds?.includes(u.id) || u.specialistIds?.includes(currentUser.id))
                        );
                        
                        const adminSupport = allUsers.filter(u =>
                            u.id !== currentUser.id &&
                            (u.roles.includes('admin') || u.roles.includes('owner'))
                        );
                        
                        return [...assignedClients, ...adminSupport];
                    }
                    return [];
                };

                const filteredChatPartners = getChatPartners().filter(partner => 
                    partner.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    partner.email.toLowerCase().includes(searchQuery.toLowerCase())
                );

                const getChatKey = (userId1, userId2) => [userId1, userId2].sort().join('-');

                const sendMessage = () => {
                    if (messageText.trim() && selectedChat) {
                        const chatKey = getChatKey(currentUser.id, selectedChat.id);
                        const currentSelectedChat = selectedChat; // Preserve the selected chat
                        const newMessage = {
                            id: Date.now(),
                            text: messageText.trim(),
                            sender: currentUser.id,
                            senderName: currentUser.name,
                            timestamp: new Date().toISOString(),
                            read: false
                        };

                        setMessages(prevMessages => {
                            const currentMessages = prevMessages[chatKey] || [];
                            const updatedMessages = {
                                ...prevMessages,
                                [chatKey]: [...currentMessages, newMessage]
                            };
                            
                            // Save to localStorage
                            try {
                                localStorage.setItem('clockworkMessages', JSON.stringify(updatedMessages));
                            } catch (error) {
                                console.error('Error saving messages:', error);
                            }
                            
                            return updatedMessages;
                        });
                        setMessageText('');
                        
                        // Reset textarea height
                        const textarea = document.querySelector('.chat-input');
                        if (textarea) {
                            textarea.style.height = '36px';
                        }
                        
                        // Simulate typing indicator for demo
                        if (Math.random() > 0.5) {
                            setTyping({ [currentSelectedChat.id]: true });
                            setTimeout(() => {
                                setTyping({});
                                // Simulate response
                                const responseMessage = {
                                    id: Date.now() + 1,
                                    text: 'Thanks for your message! I\'ll get back to you soon.',
                                    sender: currentSelectedChat.id,
                                    senderName: currentSelectedChat.name,
                                    timestamp: new Date().toISOString(),
                                    read: false
                                };
                                
                                setMessages(prevMessages => {
                                    const currentMessages = prevMessages[chatKey] || [];
                                    const updatedMessages = {
                                        ...prevMessages,
                                        [chatKey]: [...currentMessages, responseMessage]
                                    };
                                    
                                    try {
                                        localStorage.setItem('clockworkMessages', JSON.stringify(updatedMessages));
                                    } catch (error) {
                                        console.error('Error saving messages:', error);
                                    }
                                    
                                    return updatedMessages;
                                });
                            }, 2000);
                        }
                    }
                };

                const scheduleZoomCall = () => {
                    if (selectedChat) {
                        setShowZoomScheduler(true);
                    }
                };
                
                const confirmZoomSchedule = () => {
                    if (selectedChat && zoomForm.date && zoomForm.time) {
                        const chatKey = getChatKey(currentUser.id, selectedChat.id);
                        const meetingDateTime = new Date(`${zoomForm.date}T${zoomForm.time}`);
                        const meetingId = Math.floor(Math.random() * 900000000) + 100000000;
                        
                        const zoomMessage = {
                            id: Date.now(),
                            text: `üìπ Zoom meeting scheduled!\n\n` +
                                  `üìÖ Date: ${meetingDateTime.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\n` +
                                  `‚è∞ Time: ${meetingDateTime.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}\n` +
                                  `‚è±Ô∏è Duration: ${zoomForm.duration} minutes\n` +
                                  `üìù Topic: ${zoomForm.topic || 'Consultation'}\n\n` +
                                  `Join URL: https://zoom.us/j/${meetingId}\n` +
                                  `Meeting ID: ${meetingId}`,
                            sender: currentUser.id,
                            senderName: currentUser.name,
                            timestamp: new Date().toISOString(),
                            read: false,
                            isZoomLink: true
                        };

                        setMessages(prevMessages => {
                            const currentMessages = prevMessages[chatKey] || [];
                            const updatedMessages = {
                                ...prevMessages,
                                [chatKey]: [...currentMessages, zoomMessage]
                            };
                            
                            // Save to localStorage
                            try {
                                localStorage.setItem('clockworkMessages', JSON.stringify(updatedMessages));
                            } catch (error) {
                                console.error('Error saving messages:', error);
                            }
                            
                            return updatedMessages;
                        });
                        
                        // Reset form and close modal
                        setShowZoomScheduler(false);
                        setZoomForm({
                            date: new Date(Date.now() + 86400000).toISOString().split('T')[0],
                            time: '15:00',
                            duration: '60',
                            topic: ''
                        });
                    }
                };

                const formatMessageTime = (timestamp) => {
                    const date = new Date(timestamp);
                    const now = new Date();
                    const diffMs = now - date;
                    const diffMins = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMs / 3600000);
                    const diffDays = Math.floor(diffMs / 86400000);

                    if (diffMins < 1) return 'now';
                    if (diffMins < 60) return `${diffMins}m`;
                    if (diffHours < 24) return `${diffHours}h`;
                    if (diffDays < 7) return `${diffDays}d`;
                    
                    return date.toLocaleDateString();
                };

                const getUnreadCount = (partnerId) => {
                    const chatKey = getChatKey(currentUser.id, partnerId);
                    const chatMessages = messages[chatKey] || [];
                    return chatMessages.filter(msg => 
                        msg.sender !== currentUser.id && !msg.read
                    ).length;
                };

                const markAsRead = (partnerId) => {
                    const chatKey = getChatKey(currentUser.id, partnerId);
                    const chatMessages = messages[chatKey] || [];
                    if (chatMessages.length > 0) {
                        const hasUnread = chatMessages.some(msg => msg.sender !== currentUser.id && !msg.read);
                        if (hasUnread) {
                            const updatedMessages = chatMessages.map(msg => ({
                                ...msg,
                                read: true
                            }));
                            setMessages(prevMessages => {
                                const updated = {
                                    ...prevMessages,
                                    [chatKey]: updatedMessages
                                };
                                
                                // Save to localStorage
                                try {
                                    localStorage.setItem('clockworkMessages', JSON.stringify(updated));
                                } catch (error) {
                                    console.error('Error saving messages:', error);
                                }
                                
                                return updated;
                            });
                        }
                    }
                };

                const getUserRoles = (user) => {
                    return user.roles.filter(role => role !== 'client');
                };

                useEffect(() => {
                    if (messagesEndRef.current) {
                        messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });
                    }
                }, [messages, selectedChat]);

                useEffect(() => {
                    if (selectedChat) {
                        markAsRead(selectedChat.id);
                    }
                }, [selectedChat]);

                const chatMessagesForSelected = selectedChat ? (messages[getChatKey(currentUser.id, selectedChat.id)] || []) : [];

                return (
                    <div className="clockwork-card p-0 overflow-hidden">
                        <div className="chat-container">
                            <div className="chat-sidebar">
                                <div className="chat-header">
                                    <h3 className="text-lg font-semibold mb-3 text-white">Messages</h3>
                                    <input
                                        type="text"
                                        placeholder="Search conversations..."
                                        className="chat-search"
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                    />
                                </div>
                                <div className="chat-list">
                                    {filteredChatPartners.length > 0 ? (
                                        filteredChatPartners.map(partner => {
                                            const chatKey = getChatKey(currentUser.id, partner.id);
                                            const chatMessages = messages[chatKey] || [];
                                            const lastMessage = chatMessages[chatMessages.length - 1];
                                            const unreadCount = getUnreadCount(partner.id);
                                            const roles = getUserRoles(partner);
                                            
                                            return (
                                                <div
                                                    key={partner.id}
                                                    onClick={() => setSelectedChat(partner)}
                                                    className={`chat-item ${selectedChat?.id === partner.id ? 'active' : ''}`}
                                                >
                                                    <div className="chat-avatar">
                                                        {partner.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)}
                                                        {partner.online && <div className="online-indicator"></div>}
                                                    </div>
                                                    <div className="chat-item-info">
                                                        <div className="chat-item-name">
                                                            {partner.name}
                                                            {roles.length > 0 && (
                                                                <span className={`clockwork-badge badge-${roles[0]} text-xs`}>
                                                                    {roles[0]}
                                                                </span>
                                                            )}
                                                        </div>
                                                        {lastMessage && (
                                                            <div className="chat-item-message">
                                                                {lastMessage.sender === currentUser.id && 'You: '}
                                                                {lastMessage.text.length > 30 
                                                                    ? lastMessage.text.substring(0, 30) + '...'
                                                                    : lastMessage.text
                                                                }
                                                            </div>
                                                        )}
                                                    </div>
                                                    {lastMessage && (
                                                        <div className="chat-item-time">
                                                            {formatMessageTime(lastMessage.timestamp)}
                                                        </div>
                                                    )}
                                                    {unreadCount > 0 && (
                                                        <div className="unread-count">{unreadCount}</div>
                                                    )}
                                                </div>
                                            );
                                        })
                                    ) : (
                                        <div className="p-4 text-center text-gray-500 text-sm">
                                            {getChatPartners().length === 0 
                                                ? 'No available contacts' 
                                                : 'No conversations match your search'
                                            }
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div className="chat-main">
                                {selectedChat ? (
                                    <>
                                        <div className="chat-main-header">
                                            <div className="flex items-center">
                                                <div className="chat-avatar mr-3">
                                                    {selectedChat.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)}
                                                    {selectedChat.online && <div className="online-indicator"></div>}
                                                </div>
                                                <div>
                                                    <div className="font-semibold flex items-center gap-2 text-white">
                                                        {selectedChat.name}
                                                        {getUserRoles(selectedChat).map(role => (
                                                            <span key={role} className={`clockwork-badge badge-${role} text-xs`}>
                                                                {role}
                                                            </span>
                                                        ))}
                                                    </div>
                                                    <div className="text-sm text-gray-400">
                                                        {selectedChat.online ? 'Active now' : 'Offline'}
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <button onClick={scheduleZoomCall} className="zoom-btn">
                                                    <span>üìπ</span>
                                                    <span>Schedule Zoom</span>
                                                </button>
                                                <button 
                                                    onClick={() => {
                                                        if (confirm('Clear chat history with ' + selectedChat.name + '?')) {
                                                            const chatKey = getChatKey(currentUser.id, selectedChat.id);
                                                            setMessages(prev => {
                                                                const updated = { ...prev };
                                                                delete updated[chatKey];
                                                                try {
                                                                    localStorage.setItem('clockworkMessages', JSON.stringify(updated));
                                                                } catch (error) {
                                                                    console.error('Error saving messages:', error);
                                                                }
                                                                return updated;
                                                            });
                                                        }
                                                    }}
                                                    className="text-gray-400 hover:text-gray-200 text-sm p-2"
                                                    title="Clear chat history"
                                                >
                                                    üóëÔ∏è
                                                </button>
                                            </div>
                                        </div>

                                        <div className="chat-messages">
                                            {chatMessagesForSelected.map((msg, index, array) => {
                                                const showTime = index === 0 || 
                                                    new Date(msg.timestamp).getTime() - new Date(array[index - 1].timestamp).getTime() > 300000;
                                                
                                                return (
                                                    <div key={msg.id} className="message-group">
                                                        {showTime && (
                                                            <div className="message-time text-center text-xs text-gray-500 my-2">
                                                                {new Date(msg.timestamp).toLocaleString()}
                                                            </div>
                                                        )}
                                                        <div className={`flex ${msg.sender === currentUser.id ? 'justify-end' : 'justify-start'}`}>
                                                            <div className={`message-bubble ${
                                                                msg.sender === currentUser.id ? 'message-sent' : 'message-received'
                                                            } ${msg.isZoomLink ? 'zoom-meeting' : ''}`}>
                                                                {msg.text}
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                            {typing[selectedChat.id] && (
                                                <div className="typing-indicator">
                                                    <div className="typing-dot"></div>
                                                    <div className="typing-dot"></div>
                                                    <div className="typing-dot"></div>
                                                </div>
                                            )}
                                            <div ref={messagesEndRef} />
                                        </div>

                                        <div className="chat-input-container">
                                            <textarea
                                                value={messageText}
                                                onChange={(e) => {
                                                    setMessageText(e.target.value);
                                                    // Auto-resize textarea
                                                    e.target.style.height = 'auto';
                                                    e.target.style.height = Math.min(e.target.scrollHeight, 100) + 'px';
                                                }}
                                                onKeyDown={(e) => {
                                                    if (e.key === 'Enter' && !e.shiftKey) {
                                                        e.preventDefault();
                                                        sendMessage();
                                                    }
                                                }}
                                                placeholder="Type a message... (Press Enter to send, Shift+Enter for new line)"
                                                className="chat-input"
                                                rows="1"
                                                style={{ resize: 'none', overflow: 'auto', height: '36px' }}
                                            />
                                            <button 
                                                onClick={sendMessage} 
                                                className="chat-send-btn"
                                                disabled={!messageText.trim()}
                                                title="Send message"
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </>
                                ) : (
                                    <div className="flex items-center justify-center h-full text-gray-500">
                                        <div className="text-center">
                                            <span className="text-6xl">üí¨</span>
                                            <p className="mt-4 font-semibold text-gray-300">Select a conversation to start chatting</p>
                                            <p className="text-sm mt-2 text-gray-400">
                                                {filteredChatPartners.length} contact{filteredChatPartners.length !== 1 ? 's' : ''} available
                                            </p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                        
                        {showZoomScheduler && (
                            <div className="demo-modal-overlay" onClick={() => setShowZoomScheduler(false)}>
                                <div className="demo-modal-content max-w-lg" onClick={(e) => e.stopPropagation()}>
                                    <h3 className="text-xl font-semibold mb-4 text-white">
                                        Schedule Zoom Meeting with {selectedChat?.name}
                                    </h3>
                                    
                                    <div className="space-y-4">
                                        <div>
                                            <label className="form-label">Meeting Topic</label>
                                            <input
                                                type="text"
                                                value={zoomForm.topic}
                                                onChange={(e) => setZoomForm({...zoomForm, topic: e.target.value})}
                                                className="clockwork-input"
                                                placeholder="Consultation"
                                            />
                                        </div>
                                        
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="form-label">Date</label>
                                                <input
                                                    type="date"
                                                    value={zoomForm.date}
                                                    onChange={(e) => setZoomForm({...zoomForm, date: e.target.value})}
                                                    className="clockwork-input"
                                                    min={new Date().toISOString().split('T')[0]}
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="form-label">Time</label>
                                                <input
                                                    type="time"
                                                    value={zoomForm.time}
                                                    onChange={(e) => setZoomForm({...zoomForm, time: e.target.value})}
                                                    className="clockwork-input"
                                                />
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label className="form-label">Duration</label>
                                            <select
                                                value={zoomForm.duration}
                                                onChange={(e) => setZoomForm({...zoomForm, duration: e.target.value})}
                                                className="clockwork-select"
                                            >
                                                <option value="30">30 minutes</option>
                                                <option value="45">45 minutes</option>
                                                <option value="60">1 hour</option>
                                                <option value="90">1.5 hours</option>
                                                <option value="120">2 hours</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div className="flex gap-2 mt-6">
                                        <button
                                            onClick={confirmZoomSchedule}
                                            className="clockwork-button flex-1"
                                        >
                                            üìπ Schedule Meeting
                                        </button>
                                        <button
                                            onClick={() => setShowZoomScheduler(false)}
                                            className="clockwork-button bg-gray-700 hover:bg-gray-600 flex-1"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            // Function to send form data via EmailJS
            const sendFormToJosh = (formType, formData) => {
                const templateParams = {
                    to_name: 'Josh Lerner',
                    from_name: currentUser.name,
                    user_email: currentUser.email,
                    form_type: formType,
                    form_data: JSON.stringify(formData, null, 2),
                    submission_date: new Date().toLocaleString()
                };
                
                // Send email notification
                emailjs.send('service_xxxxxxx', 'template_xxxxxxx', templateParams)
                    .then(() => {
                        console.log(`${formType} form submitted successfully`);
                    })
                    .catch((error) => {
                        console.error('Failed to send form:', error);
                    });
            };

            // Measurements Component with Forms
            const MeasurementsComponent = () => {
                const [measurementForm, setMeasurementForm] = useState({
                    weight: '',
                    bodyFat: '',
                    bloodPressure: '',
                    bmr: '',
                    circumference: {
                        neck: '',
                        shoulders: '',
                        chest: '',
                        upperArm: '',
                        lowerArm: '',
                        waist: '',
                        hips: '',
                        upperThigh: '',
                        calf: ''
                    }
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const newMeasurement = {
                        ...measurementForm,
                        id: Date.now(),
                        date: new Date().toISOString().split('T')[0],
                        clientId: currentUser.id
                    };
                    
                    setClientData(prev => ({
                        ...prev,
                        measurements: [...prev.measurements, newMeasurement]
                    }));
                    
                    // Send to Josh via EmailJS
                    sendFormToJosh('Measurements', newMeasurement);
                    
                    // Reset form
                    setMeasurementForm({
                        weight: '',
                        bodyFat: '',
                        bloodPressure: '',
                        bmr: '',
                        circumference: {
                            neck: '',
                            shoulders: '',
                            chest: '',
                            upperArm: '',
                            lowerArm: '',
                            waist: '',
                            hips: '',
                            upperThigh: '',
                            calf: ''
                        }
                    });
                    
                    alert('Measurements saved successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üìè Body Measurements</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div>
                                    <label className="form-label">Weight (lbs)</label>
                                    <input
                                        type="number"
                                        step="0.1"
                                        value={measurementForm.weight}
                                        onChange={(e) => setMeasurementForm({...measurementForm, weight: e.target.value})}
                                        className="clockwork-input"
                                        required
                                    />
                                </div>
                                <div>
                                    <label className="form-label">Body Fat %</label>
                                    <input
                                        type="number"
                                        step="0.1"
                                        value={measurementForm.bodyFat}
                                        onChange={(e) => setMeasurementForm({...measurementForm, bodyFat: e.target.value})}
                                        className="clockwork-input"
                                        required
                                    />
                                </div>
                                <div>
                                    <label className="form-label">Blood Pressure</label>
                                    <input
                                        type="text"
                                        placeholder="120/80"
                                        value={measurementForm.bloodPressure}
                                        onChange={(e) => setMeasurementForm({...measurementForm, bloodPressure: e.target.value})}
                                        className="clockwork-input"
                                        required
                                    />
                                </div>
                                <div>
                                    <label className="form-label">BMR (calories)</label>
                                    <input
                                        type="number"
                                        value={measurementForm.bmr}
                                        onChange={(e) => setMeasurementForm({...measurementForm, bmr: e.target.value})}
                                        className="clockwork-input"
                                        required
                                    />
                                </div>
                            </div>
                            
                            <div className="measurement-category">
                                <h4>üìê Circumference Measurements (inches)</h4>
                                <div className="measurement-grid">
                                    {Object.keys(measurementForm.circumference).map(key => (
                                        <div key={key} className="measurement-input-group">
                                            <label>{key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1')}</label>
                                            <input
                                                type="number"
                                                step="0.1"
                                                value={measurementForm.circumference[key]}
                                                onChange={(e) => setMeasurementForm({
                                                    ...measurementForm,
                                                    circumference: {
                                                        ...measurementForm.circumference,
                                                        [key]: e.target.value
                                                    }
                                                })}
                                                className="clockwork-input"
                                            />
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            <button type="submit" className="clockwork-button">
                                Save Measurements
                            </button>
                        </form>
                        
                        <div className="mt-8">
                            <h3 className="text-lg font-semibold mb-4 text-white">Previous Measurements</h3>
                            <div className="space-y-2">
                                {clientData.measurements
                                    .filter(m => m.clientId === currentUser.id)
                                    .reverse()
                                    .slice(0, 5)
                                    .map(m => (
                                        <div key={m.id} className="bg-slate-800/50 rounded-lg p-3 border border-white/10">
                                            <div className="flex justify-between items-center">
                                                <span className="text-sm text-gray-400">{m.date}</span>
                                                <div className="flex gap-4 text-sm">
                                                    <span>Weight: <strong className="text-white">{m.weight}lbs</strong></span>
                                                    <span>Body Fat: <strong className="text-white">{m.bodyFat}%</strong></span>
                                                    <span>BP: <strong className="text-white">{m.bloodPressure}</strong></span>
                                                </div>
                                            </div>
                                        </div>
                                    ))
                                }
                            </div>
                        </div>
                    </div>
                );
            };

            // Nutrition Component with Forms
            const NutritionComponent = () => {
                const [nutritionForm, setNutritionForm] = useState({
                    protein: { target: 0, current: 0 },
                    carbs: { target: 0, current: 0 },
                    fat: { target: 0, current: 0 },
                    calories: { target: 0, current: 0 },
                    mealPlan: {
                        breakfast: '',
                        lunch: '',
                        dinner: '',
                        snacks: ''
                    }
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const nutritionData = {
                        ...nutritionForm,
                        clientId: currentUser.id,
                        assignedBy: currentUser.id,
                        date: new Date().toISOString()
                    };
                    
                    setClientData(prev => ({
                        ...prev,
                        nutrition: nutritionData
                    }));
                    
                    // Send to Josh via EmailJS
                    sendFormToJosh('Nutrition Plan', nutritionData);
                    
                    alert('Nutrition plan saved successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">ü•ó Nutrition Management</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="assignment-form">
                                <div className="assignment-header">
                                    <span>üìä</span>
                                    Daily Macros
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 className="font-semibold mb-3 text-white">Target Values</h4>
                                        <div className="space-y-3">
                                            <div>
                                                <label className="form-label">Protein (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.protein.target}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        protein: { ...nutritionForm.protein, target: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Carbs (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.carbs.target}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        carbs: { ...nutritionForm.carbs, target: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Fat (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.fat.target}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        fat: { ...nutritionForm.fat, target: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Total Calories</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.calories.target}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        calories: { ...nutritionForm.calories, target: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                    required
                                                />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 className="font-semibold mb-3 text-white">Current Intake</h4>
                                        <div className="space-y-3">
                                            <div>
                                                <label className="form-label">Protein (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.protein.current}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        protein: { ...nutritionForm.protein, current: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Carbs (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.carbs.current}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        carbs: { ...nutritionForm.carbs, current: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Fat (g)</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.fat.current}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        fat: { ...nutritionForm.fat, current: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                />
                                            </div>
                                            <div>
                                                <label className="form-label">Total Calories</label>
                                                <input
                                                    type="number"
                                                    value={nutritionForm.calories.current}
                                                    onChange={(e) => setNutritionForm({
                                                        ...nutritionForm,
                                                        calories: { ...nutritionForm.calories, current: parseInt(e.target.value) || 0 }
                                                    })}
                                                    className="clockwork-input"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="clockwork-card p-6">
                                <h4 className="font-semibold mb-4 text-white">üçΩÔ∏è Meal Plan</h4>
                                <div className="space-y-3">
                                    <div>
                                        <label className="form-label">Breakfast</label>
                                        <textarea
                                            value={nutritionForm.mealPlan.breakfast}
                                            onChange={(e) => setNutritionForm({
                                                ...nutritionForm,
                                                mealPlan: { ...nutritionForm.mealPlan, breakfast: e.target.value }
                                            })}
                                            className="clockwork-input"
                                            rows="2"
                                            placeholder="What's for breakfast?"
                                        />
                                    </div>
                                    <div>
                                        <label className="form-label">Lunch</label>
                                        <textarea
                                            value={nutritionForm.mealPlan.lunch}
                                            onChange={(e) => setNutritionForm({
                                                ...nutritionForm,
                                                mealPlan: { ...nutritionForm.mealPlan, lunch: e.target.value }
                                            })}
                                            className="clockwork-input"
                                            rows="2"
                                            placeholder="What's for lunch?"
                                        />
                                    </div>
                                    <div>
                                        <label className="form-label">Dinner</label>
                                        <textarea
                                            value={nutritionForm.mealPlan.dinner}
                                            onChange={(e) => setNutritionForm({
                                                ...nutritionForm,
                                                mealPlan: { ...nutritionForm.mealPlan, dinner: e.target.value }
                                            })}
                                            className="clockwork-input"
                                            rows="2"
                                            placeholder="What's for dinner?"
                                        />
                                    </div>
                                    <div>
                                        <label className="form-label">Snacks</label>
                                        <textarea
                                            value={nutritionForm.mealPlan.snacks}
                                            onChange={(e) => setNutritionForm({
                                                ...nutritionForm,
                                                mealPlan: { ...nutritionForm.mealPlan, snacks: e.target.value }
                                            })}
                                            className="clockwork-input"
                                            rows="2"
                                            placeholder="Any snacks?"
                                        />
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" className="clockwork-button">
                                Save Nutrition Plan
                            </button>
                        </form>
                    </div>
                );
            };

            // Workouts Component with Forms
            const WorkoutsComponent = () => {
                const [workoutForm, setWorkoutForm] = useState({
                    name: '',
                    exercises: [{
                        id: Date.now(),
                        name: '',
                        sets: 0,
                        reps: 0,
                        weight: 0,
                        notes: ''
                    }],
                    youtubeLink: ''
                });

                const addExercise = () => {
                    setWorkoutForm({
                        ...workoutForm,
                        exercises: [...workoutForm.exercises, {
                            id: Date.now(),
                            name: '',
                            sets: 0,
                            reps: 0,
                            weight: 0,
                            notes: ''
                        }]
                    });
                };

                const updateExercise = (index, field, value) => {
                    const updatedExercises = [...workoutForm.exercises];
                    updatedExercises[index][field] = value;
                    setWorkoutForm({ ...workoutForm, exercises: updatedExercises });
                };

                const removeExercise = (index) => {
                    setWorkoutForm({
                        ...workoutForm,
                        exercises: workoutForm.exercises.filter((_, i) => i !== index)
                    });
                };

                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const newWorkout = {
                        ...workoutForm,
                        id: Date.now(),
                        clientId: currentUser.id,
                        assignedBy: currentUser.id,
                        completed: false,
                        date: new Date().toISOString()
                    };
                    
                    setClientData(prev => ({
                        ...prev,
                        workouts: [...prev.workouts, newWorkout]
                    }));
                    
                    // Send to Josh via EmailJS
                    sendFormToJosh('Workout Plan', newWorkout);
                    
                    // Reset form
                    setWorkoutForm({
                        name: '',
                        exercises: [{
                            id: Date.now(),
                            name: '',
                            sets: 0,
                            reps: 0,
                            weight: 0,
                            notes: ''
                        }],
                        youtubeLink: ''
                    });
                    
                    alert('Workout created successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üí™ Workout Management</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label className="form-label">Workout Name</label>
                                <input
                                    type="text"
                                    value={workoutForm.name}
                                    onChange={(e) => setWorkoutForm({...workoutForm, name: e.target.value})}
                                    className="clockwork-input"
                                    placeholder="e.g., Upper Body Strength"
                                    required
                                />
                            </div>
                            
                            <div>
                                <label className="form-label">YouTube Tutorial Link (optional)</label>
                                <input
                                    type="url"
                                    value={workoutForm.youtubeLink}
                                    onChange={(e) => setWorkoutForm({...workoutForm, youtubeLink: e.target.value})}
                                    className="clockwork-input"
                                    placeholder="https://www.youtube.com/watch?v=..."
                                />
                            </div>
                            
                            <div className="space-y-4">
                                <div className="flex justify-between items-center">
                                    <h3 className="text-lg font-semibold text-white">Exercises</h3>
                                    <button
                                        type="button"
                                        onClick={addExercise}
                                        className="clockwork-button-secondary"
                                    >
                                        + Add Exercise
                                    </button>
                                </div>
                                
                                {workoutForm.exercises.map((exercise, index) => (
                                    <div key={exercise.id} className="exercise-card">
                                        <div className="flex justify-between items-start mb-3">
                                            <h4 className="font-semibold text-white">Exercise {index + 1}</h4>
                                            {workoutForm.exercises.length > 1 && (
                                                <button
                                                    type="button"
                                                    onClick={() => removeExercise(index)}
                                                    className="text-red-400 hover:text-red-300"
                                                >
                                                    Remove
                                                </button>
                                            )}
                                        </div>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                                            <div className="md:col-span-2 lg:col-span-1">
                                                <label className="text-sm text-gray-400">Exercise Name</label>
                                                <input
                                                    type="text"
                                                    value={exercise.name}
                                                    onChange={(e) => updateExercise(index, 'name', e.target.value)}
                                                    className="clockwork-input"
                                                    placeholder="e.g., Push-ups"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-400">Sets</label>
                                                <input
                                                    type="number"
                                                    value={exercise.sets}
                                                    onChange={(e) => updateExercise(index, 'sets', parseInt(e.target.value) || 0)}
                                                    className="clockwork-input"
                                                    min="0"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-400">Reps</label>
                                                <input
                                                    type="number"
                                                    value={exercise.reps}
                                                    onChange={(e) => updateExercise(index, 'reps', parseInt(e.target.value) || 0)}
                                                    className="clockwork-input"
                                                    min="0"
                                                    required
                                                />
                                            </div>
                                            <div>
                                                <label className="text-sm text-gray-400">Weight (lbs)</label>
                                                <input
                                                    type="number"
                                                    value={exercise.weight}
                                                    onChange={(e) => updateExercise(index, 'weight', parseInt(e.target.value) || 0)}
                                                    className="clockwork-input"
                                                    min="0"
                                                />
                                            </div>
                                            <div className="md:col-span-2 lg:col-span-4">
                                                <label className="text-sm text-gray-400">Notes</label>
                                                <input
                                                    type="text"
                                                    value={exercise.notes}
                                                    onChange={(e) => updateExercise(index, 'notes', e.target.value)}
                                                    className="clockwork-input"
                                                    placeholder="Any special instructions..."
                                                />
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            <button type="submit" className="clockwork-button">
                                Create Workout
                            </button>
                        </form>
                        
                        <div className="mt-8">
                            <h3 className="text-lg font-semibold mb-4 text-white">My Workouts</h3>
                            <div className="space-y-3">
                                {clientData.workouts
                                    .filter(w => w.clientId === currentUser.id)
                                    .map(workout => (
                                        <div key={workout.id} className="bg-slate-800/50 rounded-xl p-4 border border-white/10">
                                            <div className="flex justify-between items-center">
                                                <div>
                                                    <h4 className="font-semibold text-white">{workout.name}</h4>
                                                    <p className="text-sm text-gray-400">
                                                        {workout.exercises.length} exercises ‚Ä¢ {workout.exercises.map(e => e.name).join(', ')}
                                                    </p>
                                                </div>
                                                {workout.completed ? (
                                                    <span className="bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-sm border border-green-500/30">
                                                        ‚úì Completed
                                                    </span>
                                                ) : (
                                                    <span className="bg-yellow-500/20 text-yellow-400 px-3 py-1 rounded-full text-sm border border-yellow-500/30">
                                                        Pending
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                    ))
                                }
                            </div>
                        </div>
                    </div>
                );
            };

            // Goals Component with Forms
            const GoalsComponent = () => {
                const [goalForm, setGoalForm] = useState({
                    name: '',
                    target: '',
                    current: '',
                    deadline: '',
                    category: 'weight'
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const newGoal = {
                        ...goalForm,
                        id: Date.now(),
                        clientId: currentUser.id,
                        assignedBy: currentUser.id,
                        createdDate: new Date().toISOString()
                    };
                    
                    setClientData(prev => ({
                        ...prev,
                        goals: [...prev.goals, newGoal]
                    }));
                    
                    // Send to Josh via EmailJS
                    sendFormToJosh('Goal', newGoal);
                    
                    // Reset form
                    setGoalForm({
                        name: '',
                        target: '',
                        current: '',
                        deadline: '',
                        category: 'weight'
                    });
                    
                    alert('Goal created successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üéØ Goals Management</h2>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="assignment-form">
                                <div className="assignment-header">
                                    <span>üéØ</span>
                                    Create New Goal
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="form-label">Goal Name</label>
                                        <input
                                            type="text"
                                            value={goalForm.name}
                                            onChange={(e) => setGoalForm({...goalForm, name: e.target.value})}
                                            className="clockwork-input"
                                            placeholder="e.g., Lose 10 pounds"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Category</label>
                                        <select
                                            value={goalForm.category}
                                            onChange={(e) => setGoalForm({...goalForm, category: e.target.value})}
                                            className="clockwork-select"
                                        >
                                            <option value="weight">Weight</option>
                                            <option value="bodyfat">Body Fat</option>
                                            <option value="strength">Strength</option>
                                            <option value="endurance">Endurance</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Current Value</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={goalForm.current}
                                            onChange={(e) => setGoalForm({...goalForm, current: e.target.value})}
                                            className="clockwork-input"
                                            placeholder="Where you are now"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Target Value</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={goalForm.target}
                                            onChange={(e) => setGoalForm({...goalForm, target: e.target.value})}
                                            className="clockwork-input"
                                            placeholder="Where you want to be"
                                            required
                                        />
                                    </div>
                                    
                                    <div className="md:col-span-2">
                                        <label className="form-label">Target Date</label>
                                        <input
                                            type="date"
                                            value={goalForm.deadline}
                                            onChange={(e) => setGoalForm({...goalForm, deadline: e.target.value})}
                                            className="clockwork-input"
                                            min={new Date().toISOString().split('T')[0]}
                                            required
                                        />
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" className="clockwork-button">
                                Create Goal
                            </button>
                        </form>
                        
                        <div className="mt-8">
                            <h3 className="text-lg font-semibold mb-4 text-white">My Goals</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {clientData.goals
                                    .filter(g => g.clientId === currentUser.id)
                                    .map(goal => {
                                        const progress = Math.round((parseFloat(goal.current) / parseFloat(goal.target)) * 100);
                                        return (
                                            <div key={goal.id} className="clockwork-card p-4">
                                                <div className="flex justify-between items-start mb-3">
                                                    <h4 className="font-semibold text-white">{goal.name}</h4>
                                                    <span className={`clockwork-badge ${progress >= 100 ? 'badge-client' : 'badge-specialist'}`}>
                                                        {progress >= 100 ? 'Achieved!' : `${progress}%`}
                                                    </span>
                                                </div>
                                                <div className="space-y-2">
                                                    <div className="flex justify-between text-sm">
                                                        <span className="text-gray-400">Progress</span>
                                                        <span className="text-white">{goal.current} / {goal.target}</span>
                                                    </div>
                                                    <div className="progress-bar">
                                                        <div className="progress-fill" style={{ width: `${Math.min(progress, 100)}%` }}></div>
                                                    </div>
                                                    <div className="text-sm text-gray-400">
                                                        Deadline: {new Date(goal.deadline).toLocaleDateString()}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })
                                }
                            </div>
                        </div>
                    </div>
                );
            };

            // Reports Component with Export
            const ReportsComponent = () => {
                const generateReport = () => {
                    const reportData = {
                        user: currentUser,
                        measurements: clientData.measurements.filter(m => m.clientId === currentUser.id),
                        workouts: clientData.workouts.filter(w => w.clientId === currentUser.id),
                        goals: clientData.goals.filter(g => g.clientId === currentUser.id),
                        nutrition: clientData.nutrition?.clientId === currentUser.id ? clientData.nutrition : null,
                        tests: clientData.tests.filter(t => t.clientId === currentUser.id),
                        generatedDate: new Date().toISOString()
                    };
                    
                    // Send comprehensive report to Josh
                    sendFormToJosh('Progress Report', reportData);
                    
                    alert('Report generated and sent successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üìä Progress Report</h2>
                        
                        <div className="bg-gradient-to-r from-blue-600 to-yellow-500 text-white rounded-xl p-6 mb-6">
                            <h3 className="text-xl font-semibold mb-3">Generate Comprehensive Report</h3>
                            <p className="mb-4">
                                Create a detailed report of all your progress including measurements, workouts, nutrition, and goals.
                            </p>
                            <button onClick={generateReport} className="bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all">
                                Generate & Send Report
                            </button>
                        </div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div className="stat-card">
                                <h4 className="font-semibold mb-3 text-white">üìè Measurements Summary</h4>
                                <p className="text-gray-400">
                                    Total entries: {clientData.measurements.filter(m => m.clientId === currentUser.id).length}
                                </p>
                            </div>
                            
                            <div className="stat-card">
                                <h4 className="font-semibold mb-3 text-white">üí™ Workouts Completed</h4>
                                <p className="text-gray-400">
                                    {clientData.workouts.filter(w => w.clientId === currentUser.id && w.completed).length} of{' '}
                                    {clientData.workouts.filter(w => w.clientId === currentUser.id).length}
                                </p>
                            </div>
                            
                            <div className="stat-card">
                                <h4 className="font-semibold mb-3 text-white">üéØ Goals Progress</h4>
                                <p className="text-gray-400">
                                    {clientData.goals.filter(g => g.clientId === currentUser.id && parseFloat(g.current) >= parseFloat(g.target)).length} achieved of{' '}
                                    {clientData.goals.filter(g => g.clientId === currentUser.id).length}
                                </p>
                            </div>
                            
                            <div className="stat-card">
                                <h4 className="font-semibold mb-3 text-white">üß™ Tests Completed</h4>
                                <p className="text-gray-400">
                                    {clientData.tests.filter(t => t.clientId === currentUser.id).length} tests recorded
                                </p>
                            </div>
                        </div>
                    </div>
                );
            };

            // Tests Component
            const TestsComponent = () => {
                const [testForm, setTestForm] = useState({
                    name: '',
                    results: '',
                    notes: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    
                    const newTest = {
                        ...testForm,
                        id: Date.now(),
                        date: new Date().toISOString().split('T')[0],
                        clientId: hasRole('client') ? currentUser.id : selectedClient?.id,
                        performedBy: currentUser.id
                    };
                    
                    setClientData(prev => ({
                        ...prev,
                        tests: [...prev.tests, newTest]
                    }));
                    
                    // Send to Josh via EmailJS
                    sendFormToJosh('Test Results', newTest);
                    
                    // Reset form
                    setTestForm({
                        name: '',
                        results: '',
                        notes: ''
                    });
                    
                    alert('Test results saved successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üß™ Specialized Tests</h2>
                        
                        {hasAnyRole('specialist', 'admin', 'owner') && !selectedClient && (
                            <div className="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 mb-6">
                                <p className="text-yellow-400">Please select a client from the Dashboard to add test results.</p>
                            </div>
                        )}
                        
                        {(hasRole('client') || selectedClient) && (
                            <form onSubmit={handleSubmit} className="space-y-6">
                                <div>
                                    <label className="form-label">Test Name</label>
                                    <input
                                        type="text"
                                        value={testForm.name}
                                        onChange={(e) => setTestForm({...testForm, name: e.target.value})}
                                        className="clockwork-input"
                                        placeholder="e.g., Body Composition Analysis"
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="form-label">Results</label>
                                    <textarea
                                        value={testForm.results}
                                        onChange={(e) => setTestForm({...testForm, results: e.target.value})}
                                        className="clockwork-input"
                                        rows="4"
                                        placeholder="Enter test results..."
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="form-label">Additional Notes (optional)</label>
                                    <textarea
                                        value={testForm.notes}
                                        onChange={(e) => setTestForm({...testForm, notes: e.target.value})}
                                        className="clockwork-input"
                                        rows="2"
                                        placeholder="Any additional observations..."
                                    />
                                </div>
                                
                                <button type="submit" className="clockwork-button">
                                    Save Test Results
                                </button>
                            </form>
                        )}
                        
                        <div className="mt-8">
                            <h3 className="text-lg font-semibold mb-4 text-white">Test History</h3>
                            <div className="space-y-3">
                                {clientData.tests
                                    .filter(t => hasRole('client') ? t.clientId === currentUser.id : (selectedClient ? t.clientId === selectedClient.id : false))
                                    .reverse()
                                    .map(test => (
                                        <div key={test.id} className="bg-slate-800/50 rounded-xl p-4 border border-white/10">
                                            <div className="flex justify-between items-start mb-2">
                                                <h4 className="font-semibold text-white">{test.name}</h4>
                                                <span className="text-sm text-gray-400">{test.date}</span>
                                            </div>
                                            <p className="text-gray-300 whitespace-pre-wrap">{test.results}</p>
                                            {test.notes && (
                                                <p className="text-sm text-gray-400 mt-2">{test.notes}</p>
                                            )}
                                        </div>
                                    ))
                                }
                            </div>
                        </div>
                    </div>
                );
            };

            // Users Component
            const UsersComponent = () => {
                const [showAddUser, setShowAddUser] = useState(false);
                const [newUserForm, setNewUserForm] = useState({
                    name: '',
                    email: '',
                    password: '',
                    role: 'client'
                });

                const handleAddUser = (e) => {
                    e.preventDefault();
                    
                    const newUser = {
                        ...newUserForm,
                        id: `user_${Date.now()}`,
                        roles: [newUserForm.role],
                        online: false,
                        specialistIds: [],
                        clientIds: []
                    };
                    
                    setAllUsers(prev => [...prev, newUser]);
                    
                    // Send new user info to Josh
                    sendFormToJosh('New User Created', newUser);
                    
                    // Reset form
                    setNewUserForm({
                        name: '',
                        email: '',
                        password: '',
                        role: 'client'
                    });
                    setShowAddUser(false);
                    
                    alert('User created successfully!');
                };

                return (
                    <div className="clockwork-card p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold text-white">üë• User Management</h2>
                            <button
                                onClick={() => setShowAddUser(!showAddUser)}
                                className="clockwork-button"
                            >
                                + Add User
                            </button>
                        </div>
                        
                        {showAddUser && (
                            <form onSubmit={handleAddUser} className="assignment-form mb-6">
                                <div className="assignment-header">
                                    <span>üë§</span>
                                    Add New User
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="form-label">Full Name</label>
                                        <input
                                            type="text"
                                            value={newUserForm.name}
                                            onChange={(e) => setNewUserForm({...newUserForm, name: e.target.value})}
                                            className="clockwork-input"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Email</label>
                                        <input
                                            type="email"
                                            value={newUserForm.email}
                                            onChange={(e) => setNewUserForm({...newUserForm, email: e.target.value})}
                                            className="clockwork-input"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Password</label>
                                        <input
                                            type="password"
                                            value={newUserForm.password}
                                            onChange={(e) => setNewUserForm({...newUserForm, password: e.target.value})}
                                            className="clockwork-input"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="form-label">Role</label>
                                        <select
                                            value={newUserForm.role}
                                            onChange={(e) => setNewUserForm({...newUserForm, role: e.target.value})}
                                            className="clockwork-select"
                                        >
                                            <option value="client">Client</option>
                                            <option value="specialist">Specialist</option>
                                            <option value="admin">Admin</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div className="flex gap-2 mt-4">
                                    <button type="submit" className="clockwork-button">
                                        Create User
                                    </button>
                                    <button
                                        type="button"
                                        onClick={() => setShowAddUser(false)}
                                        className="clockwork-button bg-gray-700 hover:bg-gray-600"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        )}
                        
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead>
                                    <tr>
                                        <th className="text-left py-3 px-4 text-gray-400">Name</th>
                                        <th className="text-left py-3 px-4 text-gray-400">Email</th>
                                        <th className="text-left py-3 px-4 text-gray-400">Role</th>
                                        <th className="text-left py-3 px-4 text-gray-400">Status</th>
                                        <th className="text-left py-3 px-4 text-gray-400">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {allUsers.map(user => (
                                        <tr key={user.id}>
                                            <td className="py-3 px-4 text-white">{user.name}</td>
                                            <td className="py-3 px-4 text-gray-300">{user.email}</td>
                                            <td className="py-3 px-4">
                                                <div className="flex gap-1">
                                                    {user.roles.map(role => (
                                                        <span key={role} className={`clockwork-badge badge-${role}`}>
                                                            {role}
                                                        </span>
                                                    ))}
                                                </div>
                                            </td>
                                            <td className="py-3 px-4">
                                                {user.online ? (
                                                    <span className="text-green-400">‚óè Online</span>
                                                ) : (
                                                    <span className="text-gray-400">‚óè Offline</span>
                                                )}
                                            </td>
                                            <td className="py-3 px-4">
                                                <button className="text-blue-400 hover:text-blue-300 text-sm">
                                                    Edit
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            };

            // Engineer Component
            const EngineerComponent = () => {
                const [systemStatus, setSystemStatus] = useState({
                    database: 'operational',
                    api: 'operational',
                    storage: 'operational',
                    email: 'operational'
                });

                const runDiagnostics = () => {
                    // Simulate system check
                    setSystemStatus({
                        database: 'checking',
                        api: 'checking',
                        storage: 'checking',
                        email: 'checking'
                    });
                    
                    setTimeout(() => {
                        setSystemStatus({
                            database: 'operational',
                            api: 'operational',
                            storage: 'operational',
                            email: 'operational'
                        });
                        
                        // Send diagnostics report
                        sendFormToJosh('System Diagnostics', {
                            timestamp: new Date().toISOString(),
                            status: 'All systems operational',
                            performedBy: currentUser.name
                        });
                        
                        alert('Diagnostics complete! All systems operational.');
                    }, 2000);
                };

                return (
                    <div className="clockwork-card p-6">
                        <h2 className="text-2xl font-bold text-white mb-6">üîß Engineering Dashboard</h2>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div className="clockwork-card p-4">
                                <h3 className="font-semibold mb-4 text-white">System Status</h3>
                                <div className="space-y-3">
                                    {Object.entries(systemStatus).map(([system, status]) => (
                                        <div key={system} className="flex justify-between items-center">
                                            <span className="capitalize text-gray-300">{system}</span>
                                            <span className={`${
                                                status === 'operational' ? 'text-green-400' : 
                                                status === 'checking' ? 'text-yellow-400' : 
                                                'text-red-400'
                                            }`}>
                                                {status === 'checking' ? '‚ö° Checking...' : '‚óè ' + status}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                                
                                <button
                                    onClick={runDiagnostics}
                                    className="clockwork-button mt-4 w-full"
                                >
                                    Run Diagnostics
                                </button>
                            </div>
                            
                            <div className="clockwork-card p-4">
                                <h3 className="font-semibold mb-4 text-white">Platform Statistics</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between">
                                        <span className="text-gray-300">Total Users</span>
                                        <span className="text-white font-semibold">{allUsers.length}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-300">Active Sessions</span>
                                        <span className="text-white font-semibold">{allUsers.filter(u => u.online).length}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-300">Total Workouts</span>
                                        <span className="text-white font-semibold">{clientData.workouts.length}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span className="text-gray-300">Goals Created</span>
                                        <span className="text-white font-semibold">{clientData.goals.length}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div className="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl p-6">
                            <h3 className="text-xl font-semibold mb-3">Platform Customization</h3>
                            <p className="mb-4">
                                This platform can be customized for any industry. The owner can rebrand, modify terminology, and adapt features to match their business needs.
                            </p>
                            <button
                                onClick={() => {
                                    sendFormToJosh('Customization Request', {
                                        requestedBy: currentUser.name,
                                        timestamp: new Date().toISOString(),
                                        message: 'User requested platform customization options'
                                    });
                                    alert('Customization request sent to Josh!');
                                }}
                                className="bg-white text-purple-600 px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all"
                            >
                                Request Customization
                            </button>
                        </div>
                    </div>
                );
            };

            // Main render
            if (!currentUser) {
                return <LoginForm />;
            }

            return (
                <ErrorBoundary>
                    <div className="app-container">
                        <div className="min-h-screen p-4 max-w-7xl mx-auto">
                            {error && (
                                <div className="error-message mb-4">
                                    {error}
                                </div>
                            )}
                            
                            <Navigation />
                            
                            {activeTab === 'dashboard' && <Dashboard />}
                            {activeTab === 'measurements' && <MeasurementsComponent />}
                            {activeTab === 'nutrition' && <NutritionComponent />}
                            {activeTab === 'workouts' && <WorkoutsComponent />}
                            {activeTab === 'goals' && <GoalsComponent />}
                            {activeTab === 'chat' && <ChatComponent />}
                            {activeTab === 'reports' && <ReportsComponent />}
                            {activeTab === 'users' && <UsersComponent />}
                            {activeTab === 'tests' && <TestsComponent />}
                            {activeTab === 'engineer' && <EngineerComponent />}
                        </div>
                    </div>
                </ErrorBoundary>
            );
        };

        ReactDOM.render(<App />, document.getElementById('demo-root'));
    </script>
</body>
</html>